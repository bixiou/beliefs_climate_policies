webpackJsonp([23,42,47,59,65],[,,,,,,,,,,,,,,,,,function(e,i,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=r(23);r.n(t)},,,,,,function(e,i){},,,,,function(e,i,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=(r(17),r(32)),n=(r.n(t),r(33),r(34)),o=(r.n(n),r(35)),a=(r.n(o),r(36)),s=(r.n(a),r(37)),l=(r.n(s),r(38)),d=(r.n(l),r(39),r(40)),c=(r.n(d),r(41),r(42)),u=(r.n(c),r(43),r(45),r(47)),w=(r.n(u),r(48)),p=(r.n(w),r(49));r.n(p),r(50)},function(e,i,r){"use strict";var t=window.LibraryService;i.a=t},function(e,i,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=r(55),n=(r.n(t),r(56)),o=(r.n(n),r(57),r(59)),a=(r.n(o),r(60)),s=(r.n(a),r(61)),l=(r.n(s),r(62)),d=(r.n(l),r(63));r.n(d)},function(e,i,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=r(64),n=(r.n(t),r(65));r.n(n)},function(e,i){angular.module("cp.library.shared",["cp.shared.ngenteresc"]),angular.module("cp.library.nopermission",["cp.library.shared.selector"])},function(e,i,r){"use strict";var t=r(4),n=r(29),o=r(12),a=(r(108),r(115),r(112),window.Event);window.GraphicsLibrary={thumbHeight:70,thumbWidth:70,init:function(){window.QModules.loadModule("QGraphics.js"),window.GraphicsLibrary.loadThumbs(),window.GraphicsLibrary.updateCategorySelector(),new window.Form.Element.Observer("GraphicSearchInput",1,window.GraphicsLibrary.searchGraphics),a.observe("GraphicSearchInput","keypress",window.LibraryGlobal.stopEnter)},searchGraphics:function(){var e=window.$("CategorySelector").value,i=window.$("GraphicSearchInput").value;window.$("GraphicSearchInput").hasClassName("AutoClearMessage")&&(i=""),window.GraphicsLibrary.loadThumbs(e,i)},loadThumbsOnChange:function(){window.GraphicsLibrary.searchGraphics()},loadThumbs:function(e,i){var r=window.$("AllowUpload").value,o="";void 0!=i&&(o=i),null==e&&(e="All");var s=window.$("Thumbnails").getWidth(),l=Math.floor(s/109),d=this;window.$("Thumbnails").empty()&&window.$("Thumbnails").insert({bottom:window.QAjaxWaiter.showMediumRing()}),new window.Ajax.Request(t.a.getAjaxURL("GetLibraryGraphics",null,{LibraryID:n.a.activeLibraryId,category:e,search:o}),{onSuccess:function(i){try{var t=window.$("Thumbnails").down("mediumRingLoadingImage");if(t&&t.remove(),""!=i.responseText){var n=i.responseText.evalJSON(),o=[];for(var s in n){var c=[],u=n[s],w=window.QBuilder("div",{className:"categorytitle"},s);c.push(w);var p=0;if(!(u instanceof Array))for(var y in u){var v=u[y].Description,g=u[y].LastModified;void 0==g&&(g="0");var b=window.QBuilder("div",{id:"thumbnail_"+y,className:"thumbcontainer",clickcallback:"GraphicsLibrary.expandThumbnail",p1:y,p2:v,p3:s,p4:g},[window.QBuilder("div",{className:"thumbframe",bubbleup:!0,clickcallback:"GraphicsLibrary.expandThumbnail",p1:y,p2:v,p3:s,p4:g},[window.QAjaxWaiter.showSmallBar(),window.QBuilder("img",{id:"image_"+y,src:"Graphic.php?thumb=true&IM="+y+"&V="+g,bubbleup:!0,clickcallback:"GraphicsLibrary.expandThumbnail",p1:y,p2:v,p3:s,p4:g})]),window.QBuilder("span",{bubbleup:!0},v)]);b.gid=y,new window.Draggable(b,{revert:"failure",ghosting:!1,onStart:function(e){var i=e.element;e.originalParent=i.parentNode,d.dragStart=new Date},onEnd:function(e){e.element}}),c.push(b),p++,p==l&&(p=0)}if(void 0!==window.FileReader&&r){var m=window.QBuilder("span",{id:s+"~ThumbPlaceholder",name:s,className:"DropPlaceholder"},[window.QBuilder("span",{className:"DropMessage"},window.getMessage("LibrarySection","DragToUpload"))]);c.push(m)}else{var f=window.QBuilder("span",{className:"DropPlaceholder"});c.push(f)}var S=window.QBuilder("div",{className:"clear"});c.push(S);var h=window.QBuilder("div",{className:"categorycontainer",id:s+"~div",name:s},c);window.Droppables.add(h,{hoverclass:"DropOver",onDrop:function(i,r,t){var n=new Date;if(d.dragStart&&n.getTime()-d.dragStart.getTime()<300)return void(d.dragStart=null);d.dragStart&&(d.dragStart=null),i.parentNode.removeChild(i),r.down(".DropPlaceholder").insert({before:i}),window.$(i).setStyle({left:"auto",top:"auto"});var o=i.gid;e=r.category,d.updateCategory(o,e)}}),h.category=s,o.push(h)}var C=window.QBuilder("div",{className:"innerContainer"},o);if(window.$("Thumbnails").innerHTML="",window.$("Thumbnails").appendChild(C),window.$("Thumbnails").setStyle({display:"block"}),void 0!==window.FileReader&&r)for(var L in n)a.observe(window.$(L+"~div"),"dragenter",d.dragenter.bind(d)),a.observe(window.$(L+"~div"),"dragleave",d.dragexit.bind(d)),a.observe(window.$(L+"~div"),"dragover",d.dragover.bind(d)),a.observe(window.$(L+"~div"),"drop",d.drop.bind(d))}else{window.$("Thumbnails").innerHTML="";var Q=window.QBuilder("div",{className:"NoSurveyMessage"}),B=void 0;B=void 0!==window.FileReader?window.getMessage("LibrarySection","CurrentlyNoGraphics")+" "+(r?'<a clickcallback="UploadQGraphic.uploadGraphic">'+window.getMessage("LibrarySection","ClickOrDragToUpload")+"</a>":""):window.getMessage("LibrarySection","CurrentlyNoGraphics")+" "+(r?'<a clickcallback="UploadQGraphic.uploadGraphic">'+window.getMessage("LibrarySection","ClickToUploadGraphic")+"</a>":""),Q.innerHTML=B,window.$("Thumbnails").appendChild(Q),void 0!==window.FileReader&&r&&(a.observe(window.$("Thumbnails"),"dragenter",d.dragenter.bind(d)),a.observe(window.$("Thumbnails"),"dragleave",d.dragexit.bind(d)),a.observe(window.$("Thumbnails"),"dragover",d.dragover.bind(d)),a.observe(window.$("Thumbnails"),"drop",d.drop.bind(d)))}}catch(e){console.error(e)}}})},updateCategory:function(e,i){var r=window.$F("LibrarySelect");new window.Ajax.Request(t.a.getAjaxURL("UpdateGraphicCategory"),{parameters:{lid:r,category:i,gid:e},onSuccess:function(e){}})},expandThumbnail:function(e,i,r,t){var n=window.$("AllowDelete").value,o=window.$("AllowUpdate").value,a=window.QBuilder("img",{src:"Graphic.php?IM="+e+"&V="+t}),s={gid:e,category:r,update:!0,destination:"library"},l=window.$("LibrarySelect").value,d={title:"Delete Library Graphic",strong:!1,deleteButtonText:"Delete",deleteMessage:"Are you sure you wish to delete the graphic '"+i+"' from the library?",deleteCallBackParameters:{ajaxAction:"DeleteGraphic",ajaxParameters:{GID:e,LID:l},ajaxOnComplete:"GraphicsLibrary.deleteGraphicOnClose"}},c=window.QBuilder("div",{className:"imageToolbar",id:"imageToolbar"},[n?window.QBuilder("div",{title:"Delete Image From Library",className:"deleteButton",id:"deleteButton",clickcallback:"QualtricsCPTools.showDeleteConfirmation",p1:Object.toJSON(d)}):"",o?window.QBuilder("div",{title:"Edit Graphic",className:"updateButton",id:"updateButton",clickcallback:"UploadQGraphic.uploadGraphic",p1:Object.toJSON(s)}):"",window.QBuilder("div",{title:window.getMessage("LibrarySection","CopyGraphic"),className:"copyButton",id:"copyButton",clickcallback:"InsertQGraphic.copyGraphicPopup",p1:e,p2:i,p3:"library"})]);window.$(c).setStyle({width:(n?55:0)+(o?55:0)+55+"px",height:"51px"});var u=window.QBuilder("div",{className:"clear"}),w=window.QBuilder("div",{className:"imageContainer"},[a,c,u]);a.onload=window.Q_Window.centerWindows;var p=new window.Q_Window({id:"ImagePreview",title:i,closeButton:!0,width:"auto",height:"auto"});p.setContent(w),p.center()},updateCategorySelector:function(e){new window.Ajax.Request(t.a.getAjaxURL("GetGraphicsCategories",null,{LibraryID:n.a.activeLibraryId}),{onSuccess:function(i){var r=i.responseText.evalJSON();window.GraphicsLibrary.GraphicsCategories=r;var t=[],n=window.QBuilder("option",{value:"All"},window.getMessage("LibrarySection","All"));if(t.push(n),!(r instanceof Array))for(var o in r){var s=window.QBuilder("option",{value:o},o);o==e&&s.setAttribute("selected",""),t.push(s)}var l=window.QBuilder("select",{id:"CategorySelector"},t);a.observe(l,"change",window.GraphicsLibrary.loadThumbsOnChange),window.$("CategorySelectorContainer").innerHTML="",window.$("CategorySelectorContainer").appendChild(l)}})},deleteGraphicOnClose:function(){window.GraphicsLibrary.loadThumbsOnChange(),window.Q_Window.closeWindow("ImagePreview")},deleteGraphic:function(e,i){if(confirm("Are you sure you wish to delete the graphic '"+i+"' from the library?")){var r=window.$("LibrarySelect").value;new window.Ajax.Request(t.a.getAjaxURL("deleteGraphic"),{parameters:{LID:r,GID:e},onSuccess:function(i){window.Q_Window.closeWindow("ImagePreview"),window.$("thumbnail_"+e).remove()}})}},updateGraphic:function(){new window.Q_Window({id:"updateGraphic",title:window.getMessage("Graphics","UpdateLibraryGraphic"),closeButton:!0,width:"auto",height:"auto",buttons:[{icon:"cancel",text:window.getMessage("SiteWide","Cancel"),click:"GraphicsLibrary.cancelUpdate",className:"negative"},{icon:"check",text:window.getMessage("SiteWide","Save"),click:"GraphicsLibrary.saveUpate",className:"positive"}]}).center()},dragenter:function(e){a.stop(e)},dragexit:function(e){a.stop(e),this.over&&window.$(this.over).removeClassName("DropOver"),this.over=null},dragover:function(e){if(a.stop(e),this.over=e.target,e.target.name)-1==e.target.id.indexOf("~div")&&(this.over=e.target.parentElement);else if("Thumbnails"!=this.over.id)for(var i=0;i<4&&(this.over=this.over.parentElement,!(this.over.name&&this.over.id.indexOf("~div")>-1));i++);window.$(this.over).addClassName("DropOver")},drop:function(e){a.stop(e),this.over&&window.$(this.over).removeClassName("DropOver");var i=this.over.name?this.over.name:"Unassigned";this.over=null;var r=e.target.files||e.dataTransfer.files;if(!r)return void alert(window.getMessage("LibrarySection","NoDragDropSupport"));var t=window.$("LibrarySelect").value;if(t)for(var n,o=0;n=r[o];o++)this.fileload(n,t,i)},fileload:function(e,i,r){var n=this,o=null;if(e.size>3e7)o="Uploaded files must be 30000k or less";else if(this.isSupportedUpload(e.type)){var a=window.$(r+"~ThumbPlaceholder");a?(a.down().setStyle({display:"none"}),a.addClassName("DropWait"),a.insert({top:window.QAjaxWaiter.showMediumRing()})):window.$("Thumbnails").insert({bottom:window.QAjaxWaiter.showMediumRing()}),new window.Ajax.Request(t.a.getAjaxURL("UploadDroppedLibraryElement",null,{lid:i,category:r}),{method:"post",postBody:e,contentType:"application/octet-stream",requestHeaders:{"X-AJAX-FILENAME":e.name,"X-AJAX-FILETYPE":e.type,"X-AJAX-CHECKFORDUPES":!1},onComplete:function(e){n.updateCategorySelector(0==window.$("CategorySelector").selectedIndex?"All":r),n.loadThumbs()}})}else o="Unsupported file type: "+e.type;o&&function(){alert(o)}.defer()},isSupportedUpload:function(e){return 0==e.indexOf("image")}},window.FilesLibrary={init:function(){window.FilesLibrary.loadThumbs(),window.FilesLibrary.updateCategorySelector(),new window.Form.Element.Observer("FileSearchInput",1,window.FilesLibrary.searchFiles)},searchFiles:function(){var e=window.$("CategorySelector").value,i=window.$("FileSearchInput").value;window.$("FileSearchInput").hasClassName("AutoClearMessage")&&(i=""),window.FilesLibrary.loadThumbs(e,i)},loadThumbsOnChange:function(){window.FilesLibrary.searchFiles()},loadThumbs:function(e,i){var r=window.$F("AllowUpload"),o="";void 0!=i&&(o=i),null==e&&(e="All");var s=window.$("Thumbnails").getWidth(),l=Math.floor(s/109),d=this;window.$("Thumbnails").empty()&&window.$("Thumbnails").insert({bottom:window.QAjaxWaiter.showMediumRing()}),new window.Ajax.Request(t.a.getAjaxURL("GetLibraryFiles",null,{LibraryID:n.a.activeLibraryId}),{parameters:{category:e,search:o},onSuccess:function(e){var i=window.$("Thumbnails").down("mediumRingLoadingImage");if(i&&i.remove(),""!=e.responseText){var t=e.responseText.evalJSON(),n=[];for(var o in t){var s=[],c=t[o],u=window.QBuilder("div",{className:"categorytitle"},o);s.push(u);var w=0;if(!(c instanceof Array))for(var p in c){var y=c[p].Description,v=c[p].LastModified,g=c[p].Extension;void 0==v&&(v="0");var b=window.QBuilder("div",{id:"thumbnail_"+p,className:"thumbcontainer",clickcallback:"FilesLibrary.expandThumbnail",p1:p,p2:y,p3:o,p4:v},[window.QBuilder("div",{className:"thumbframe",clickcallback:"FilesLibrary.expandThumbnail",p1:p,p2:y,p3:o,p4:v},[window.QBuilder("div",{id:"file_"+p,className:"GraphicThumb "+g,clickcallback:"FilesLibrary.expandThumbnail",p1:p,p2:y,p3:o,p4:v})]),window.QBuilder("span",{},y)]);if(s.push(b),++w==l){w=0;var m=window.QBuilder("div",{className:"clear"});s.push(m)}}var f=window.QBuilder("span",{id:o+"~ThumbPlaceholder",name:o,className:"DropPlaceholder"},[window.QBuilder("span",{className:"DropMessage"},window.getMessage("LibrarySection","DragToUpload"))]);s.push(f);var S=window.QBuilder("div",{className:"clear"});s.push(S);var h=window.QBuilder("div",{className:"categorycontainer",id:o+"~div",name:o},s);n.push(h)}var C=window.QBuilder("div",{className:"innerContainer"},n);if(window.$("Thumbnails").innerHTML="",window.$("Thumbnails").appendChild(C),window.$("Thumbnails").setStyle({display:"block"}),void 0!==window.FileReader&&r)for(var L in t)a.observe(window.$(L+"~div"),"dragenter",d.dragenter.bind(d)),a.observe(window.$(L+"~div"),"dragleave",d.dragexit.bind(d)),a.observe(window.$(L+"~div"),"dragover",d.dragover.bind(d)),a.observe(window.$(L+"~div"),"drop",d.drop.bind(d))}else{window.$("Thumbnails").innerHTML="";var Q=window.QBuilder("div",{className:"NoSurveyMessage"}),B=void 0;B=void 0!==window.FileReader?window.getMessage("LibrarySection","CurrentlyNoFiles")+" "+(r?'<a clickcallback="UploadQFile.uploadFile">'+window.getMessage("LibrarySection","ClickOrDragToUpload")+"</a>":""):window.getMessage("LibrarySection","CurrentlyNoFiles")+" "+(r?'<a clickcallback="UploadQFile.uploadFile">'+window.getMessage("LibrarySection","ClickToUploadFile")+"</a>":""),Q.innerHTML=B,window.$("Thumbnails").appendChild(Q),void 0!==window.FileReader&&r&&(a.observe(window.$("Thumbnails"),"dragenter",d.dragenter.bind(d)),a.observe(window.$("Thumbnails"),"dragleave",d.dragexit.bind(d)),a.observe(window.$("Thumbnails"),"dragover",d.dragover.bind(d)),a.observe(window.$("Thumbnails"),"drop",d.drop.bind(d)))}}})},expandThumbnail:function(e,i,r,o){var a=window.$("AllowDelete").value,s=window.$("AllowUpdate").value,l=window.QBuilder("div",{id:"fileLinkContainer"},[window.QBuilder("a",{href:"File.php?F="+e+"&download=1",target:"_blank"},[window.QBuilder("span",{},[window.QBuilder("strong",window.getMessage("Files","DownloadFile"))])])]),d=window.QBuilder("div",{id:"fileInfoBucket"}),c=window.QBuilder("div",{id:"fileInfoContainer"},[d,window.QBuilder("hr"),l]),u={fid:e,category:r,update:!0,destination:"library"},w=window.$("LibrarySelect").value,p={title:"Delete Library File",strong:!1,deleteButtonText:"Delete",deleteMessage:"Are you sure you wish to delete the File '"+i+"' from the library?",deleteCallBackParameters:{ajaxAction:"DeleteFile",ajaxParameters:{FID:e,LID:w},ajaxOnComplete:"FilesLibrary.deleteFileOnClose"}},y=window.QBuilder("div",{className:"fileToolbar",id:"fileToolbar"},[a?window.QBuilder("div",{title:"Delete File From Library",className:"deleteButton",id:"deleteButton",clickcallback:"QualtricsCPTools.showDeleteConfirmation",p1:Object.toJSON(p)}):"",s?window.QBuilder("div",{title:"Edit File",className:"updateButton",id:"updateButton",clickcallback:"UploadQFile.uploadFile",p1:Object.toJSON(u)}):"",window.QBuilder("div",{title:window.getMessage("LibrarySection","CopyFile"),className:"copyButton",id:"copyButton",clickcallback:"InsertQFile.copyFilePopup",p1:e,p2:i,p3:"library"})]);window.$(y).setStyle({width:(a?55:0)+(s?55:0)+55+"px",height:"51px"});var v=window.QBuilder("div",{className:"clear"}),g=window.QBuilder("div",{className:"fileContainer"},[c,y,v]);l.onload=window.Q_Window.centerWindows;var b=new window.Q_Window({id:"FilePreview",title:i,closeButton:!0,width:"auto",height:"auto"});b.setContent(g),b.center(),new window.Ajax.Request(t.a.getAjaxURL("GetFileInfo",null,{LibraryID:n.a.activeLibraryId}),{parameters:{FileID:e},onSuccess:function(i){var r=i.responseText.evalJSON(),t=r.Size,n="B";t>1024&&(t/=1024,n="KB"),t>1024&&(t/=1024,n="MB");var o=window.QBuilder("a",{href:"File.php?F="+e,target:"_blank"},[window.QBuilder("div",{className:"GraphicThumb "+r.Extension})]),a=window.QBuilder("tr",{id:"sizeInfoRow"},[window.QBuilder("td",{rowSpan:2,className:"thumbframe",align:"center"},[o]),window.QBuilder("td",{className:"left"},window.getMessage("Files","FileSize")),window.QBuilder("td",{className:"right"},Math.round(t)+n)]),s=window.QBuilder("tr",{id:"typeInfoRow"},[window.QBuilder("td",{className:"left"},window.getMessage("Files","FileType")),window.QBuilder("td",{className:"right"},r.Type)]),l=window.QBuilder("tr",{id:"filenameInfoRow"},[window.QBuilder("td",{className:"center"},[window.QBuilder("a",{href:"File.php?F="+e,target:"_blank"},r.OrigFilename)])]),d=window.QBuilder("table",{className:"fileInfo"},[window.QBuilder("tbody",{},[a,s,l])]);window.$("fileInfoBucket").appendChild(d)}})},updateCategorySelector:function(e){new window.Ajax.Request(t.a.getAjaxURL("GetFilesCategories",null,{LibraryID:n.a.activeLibraryId}),{onSuccess:function(i){var r=i.responseText.evalJSON();window.FilesLibrary.FilesCategories=r;var t=[],n=window.QBuilder("option",{value:"All"},window.getMessage("LibrarySection","All"));if(t.push(n),!(r instanceof Array))for(var o in r){var s=window.QBuilder("option",{value:o},o);o==e&&s.setAttribute("selected",""),t.push(s)}var l=window.QBuilder("select",{id:"CategorySelector"},t);a.observe(l,"change",window.FilesLibrary.loadThumbsOnChange),window.$("CategorySelectorContainer").innerHTML="",window.$("CategorySelectorContainer").appendChild(l)}})},deleteFileOnClose:function(){window.FilesLibrary.loadThumbsOnChange(),window.Q_Window.closeWindow("FilePreview")},deleteFile:function(e,i){if(confirm("Are you sure you wish to delete the File '"+i+"' from the library?")){var r=window.$("LibrarySelect").value;new window.Ajax.Request(t.a.getAjaxURL("deleteFile"),{parameters:{LID:r,FID:e},onSuccess:function(i){window.Q_Window.closeWindow("FilePreview"),window.$("thumbnail_"+e).remove()}})}},updateFile:function(){new window.Q_Window({id:"updateFile",title:window.getMessage("Files","UpdateLibraryFile"),closeButton:!0,width:"auto",height:"auto",buttons:[{icon:"cancel",text:window.getMessage("SiteWide","Cancel"),click:"FilesLibrary.cancelUpdate",className:"negative"},{icon:"check",text:window.getMessage("SiteWide","Save"),click:"FilesLibrary.saveUpate",className:"positive"}]}).center()},dragenter:function(e){a.stop(e)},dragexit:function(e){a.stop(e),this.over&&window.$(this.over).removeClassName("DropOver"),this.over=null},dragover:function(e){if(a.stop(e),this.over=e.target,e.target.name)-1==e.target.id.indexOf("~div")&&(this.over=e.target.parentElement);else if("Thumbnails"!=this.over.id)for(var i=0;i<4&&(this.over=this.over.parentElement,!(this.over.name&&this.over.id.indexOf("~div")>-1));i++);window.$(this.over).addClassName("DropOver")},drop:function(e){a.stop(e),this.over&&window.$(this.over).removeClassName("DropOver");var i=this.over.name?this.over.name:"Unassigned";this.over=null;var r=e.target.files||e.dataTransfer.files;if(!r)return void alert(window.getMessage("LibrarySection","NoDragDropSupport"));var t=window.$("LibrarySelect").value;if(t)for(var n,o=0;n=r[o];o++)this.fileload(n,t,i)},fileload:function(e,i,r){var n=this,o=null;if(e.size>3e7)return o="Uploaded files must be 30000k or less",void alert(o);if(this.isSupportedUpload(e.type)){var a=window.$(r+"~ThumbPlaceholder");a?(a.down().setStyle({display:"none"}),a.addClassName("DropWait"),a.insert({top:window.QAjaxWaiter.showMediumRing()})):window.$("Thumbnails").insert({bottom:window.QAjaxWaiter.showMediumRing()}),new window.Ajax.Request(t.a.getAjaxURL("UploadDroppedLibraryElement",null,{lid:i,category:r,isImage:!1}),{method:"post",postBody:e,contentType:"application/octet-stream",requestHeaders:{"X-AJAX-FILENAME":e.name,"X-AJAX-FILETYPE":e.type,"X-AJAX-CHECKFORDUPES":!1},onComplete:function(e){n.updateCategorySelector(0==window.$("CategorySelector").selectedIndex?"All":r),n.loadThumbs()}})}else o="Unsupported file type: "+e.type;o&&function(){alert(o)}.defer()},isSupportedUpload:function(e){return!0}},window.SurveyLibrary={init:function(){window.SurveyLibrary.loadSurveys(),window.SurveyLibrary.updateCategorySelector(),new window.Form.Element.Observer("SurveySearchInput",1,window.SurveyLibrary.loadSurveysOnChange),a.observe("SurveySearchInput","keypress",window.LibraryGlobal.stopEnter)},loadSurveysOnChange:function(){var e=window.$("CategorySelector").value,i=window.$("SurveySearchInput").value;window.$("SurveySearchInput").hasClassName("AutoClearMessage")&&(i=""),window.SurveyLibrary.loadSurveys(e,i)},loadSurveys:function(e,i){var r="";void 0!=i&&(r=i);var o=window.$("AllowUpload").value;void 0==e&&(e="All"),new window.Ajax.Request(t.a.getAjaxURL("GetLibrarySurveys",null,{LibraryID:n.a.activeLibraryId}),{parameters:{category:e,search:r},onSuccess:function(e){if(""!=e.responseText){var i=e.responseText.evalJSON(),r=[];for(var t in i){var n=[],a=i[t],s=window.QBuilder("div",{className:"categorytitle"},t);if(n.push(s),!(a instanceof Array)){var l=[];for(var d in a){var c=a[d],u={title:window.getMessage("LibrarySection","DeleteLibrarySurvey"),strong:!1,deleteButtonText:window.getMessage("SiteWide","Delete"),deleteMessage:window.getMessage("LibrarySection","DeleteLibrarySurveyConfirm",c),deleteCallBackParameters:{ajaxAction:"DeleteLibrarySurvey",ajaxParameters:{sid:d},ajaxOnComplete:"SurveyLibrary.loadSurveysOnChange"}},w=window.QBuilder("td",{className:"icon"},[window.QBuilder("div",{className:"iconContainer",clickcallback:"SurveyLibrary.viewSurvey",p1:d,p2:a[d]})]),p=window.QBuilder("td",{className:"description",clickcallback:"SurveyLibrary.viewSurvey",p1:d,p2:a[d]},c),y=window.QBuilder("td",{className:"view"},[window.QBuilder("a",{className:"iconContainer",clickcallback:"SurveyLibrary.viewSurvey",p1:d,p2:a[d]},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","View"))])]),v="";window.$("AllowEdit")&&"1"==window.$("AllowEdit").value&&(v=window.QBuilder("td",{className:"edit"},[window.QBuilder("a",{className:"iconContainer",clickcallback:"SurveyLibrary.editSurvey",p1:d},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Edit"))])]));var g="";window.$("AllowTranslate")&&"1"==window.$("AllowTranslate").value&&(g=window.QBuilder("td",{className:"translate"},[window.QBuilder("a",{className:"iconContainer",clickcallback:"SurveyLibrary.translateSurvey",p1:d},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Translate"))])]));var b=window.QBuilder("td",{className:"options"},[window.$("AllowDelete").value?window.QBuilder("a",{className:"iconContainer",clickcallback:"SurveyLibrary.surveyOptions",p1:d,p2:a[d],p3:t},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Options"))]):window.QBuilder("a",{className:"iconContainer disabled"},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Options"))])]),m=window.QBuilder("td",{className:"copy"},[window.$("AllowCopy").value?window.QBuilder("a",{className:"iconContainer",clickcallback:"SurveyLibrary.copySurvey",p1:d,p2:a[d],p3:t},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Copy"))]):window.QBuilder("a",{className:"iconContainer disabled"},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Copy"))])]),f=window.QBuilder("td",{className:"delete"},[window.$("AllowDelete").value?window.QBuilder("a",{className:"iconContainer",clickcallback:"QualtricsCPTools.showDeleteConfirmation",p1:Object.toJSON(u)},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Delete"))]):window.QBuilder("a",{className:"iconContainer disabled"},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Delete"))])]),S=window.QBuilder("tr",{id:"row_"+d,className:"row"},[w,p,v,g,y,b,m,f]);l.push(S)}var h=window.QBuilder("table",{},[window.QBuilder("tbody",{},l)]);n.push(h)}var C=window.QBuilder("div",{className:"categorycontainer"},n);r.push(C)}var L=window.QBuilder("div",{},r);window.$("Surveys").innerHTML="",window.$("Surveys").appendChild(L),window.$("Surveys").setStyle({display:"block"})}else{window.$("Surveys").innerHTML="";var Q=window.QBuilder("div",{className:"NoSurveyMessage"}),B=window.getMessage("LibrarySection","CurrentlyNoSurveys")+" "+(o?'<a clickcallback="SurveyLibrary.copySurveyToLibrary">'+window.getMessage("LibrarySection","ClickToCopySurvey")+"</a>":"");Q.innerHTML=B,window.$("Surveys").appendChild(Q)}}})},updateCategorySelector:function(e){new window.Ajax.Request(t.a.getAjaxURL("GetSurveyCategories",null,{LibraryID:n.a.activeLibraryId}),{onSuccess:function(i){var r={};""!=i.responseText&&(r=i.responseText.evalJSON()),window.SurveyLibrary.SurveyCategories=r;var t=[],n=window.QBuilder("option",{value:"All"},window.getMessage("LibrarySection","All"));t.push(n);for(var o in r){var s=window.QBuilder("option",{value:o},o);o==e&&s.setAttribute("selected",""),t.push(s)}var l=window.QBuilder("select",{id:"CategorySelector"},t);a.observe(l,"change",window.SurveyLibrary.loadSurveysOnChange),window.$("CategorySelectorContainer").innerHTML="",window.$("CategorySelectorContainer").appendChild(l)}})},viewSurvey:function(e,i,r){r||(r=window.$("LibrarySelect").value);var n="ViewSurvey_"+e+"_"+r;new window.Q_Window({id:n,title:i,width:"900px",height:"80%",className:"view-survey",url:t.a.getAjaxURL("GetSurveyPreview",null,{LID:r,SID:e}),iframescrolling:!0,onClose:function(){var e=window.Q_Window.getInstance(n);e.iframe&&e.iframe.parentNode.removeChild(e.iframe)},buttons:[{text:"Close",click:"Q_Window.closeWindow",className:"btn btn-hover"}]})},surveyOptions:function(e,i,r){var t=window.SurveyLibrary.SurveyCategories,n=[],o=!1,a=!1;for(var s in t){"Unassigned"==s&&(o=!0);var l=window.QBuilder("option",{value:s},s);s==r&&(l.setAttribute("selected","selected"),a=!0),n.push(l)}if(!o){var d=window.QBuilder("option",{value:"Unassigned"},window.getMessage("LibrarySection","Unassigned"));a||d.setAttribute("selected","selected"),n.push(d)}var c=window.QBuilder("select",{id:"LibrarySurveyCategory",name:"category",className:"input"},n),u=window.QBuilder("form",{id:"SurveyLibraryOptionsForm"},[window.QBuilder("input",{type:"hidden",name:"sid",value:e}),window.QBuilder("table",{},[window.QBuilder("tbody",{},[window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Category")),window.QBuilder("td",{},[window.QBuilder("div",{className:"categoryInputContainer"},[c])])]),window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Description")),window.QBuilder("td",{},[window.QBuilder("div",{},[window.QBuilder("input",{type:"text",name:"description",value:i,className:"input TextBox"})])])])])])]);new window.Q_Window({id:"LibrarySurveyOptions",title:window.getMessage("LibrarySection","LibrarySurveyOptions"),width:"auto",height:"auto",closeButton:!0,buttons:[{icon:"cancel",text:window.getMessage("SiteWide","Cancel"),click:"SurveyLibrary.cancelSurveyOptions",className:"negative"},{icon:"check",text:window.getMessage("SiteWide","Save"),click:"SurveyLibrary.saveSurveyOptions",className:"positive"}]}).setContent(u),window.QComboBox.replaceSelect(c,{autoComplete:!0})},cancelSurveyOptions:function(){window.Q_Window.closeWindow("LibrarySurveyOptions")},saveSurveyOptions:function(){var e=window.$("CategorySelector").value,i=window.$("SurveyLibraryOptionsForm").serialize(!0),r=this;new window.Ajax.Request(t.a.getAjaxURL("saveLibrarySurveyOptions",null,{LibraryID:n.a.activeLibraryId}),{parameters:i,onSuccess:function(i){window.Q_Window.closeWindow("LibrarySurveyOptions"),r.loadSurveys(e),r.updateCategorySelector(e)}})},copySurvey:function(e,i,r){var o=window.QBuilder("tr",{id:"CopyLibraryCategoryRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Category")),window.QBuilder("td",{},[window.QBuilder("div",{className:"categoryInputContainer",id:"CopyLibrarySurveyCategoryContainer"})])]);window.$(o).setStyle({display:"none"});var s=window.QBuilder("form",{id:"copyLibrarySurveyForm"},[window.QBuilder("input",{name:"sid",type:"hidden",value:e}),window.QBuilder("table",{},[window.QBuilder("tbody",{},[window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("EditSection","Destination")),window.QBuilder("td",{},[window.QBuilder("div",{id:"DestinationSelectContainer"})])]),o,window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","SurveyName")),window.QBuilder("td",{},[window.QBuilder("input",{className:"TextBox",name:"surveyname",type:"text",value:i})])])])])]);new window.Q_Window({id:"LibrarySurveyCopy",title:window.getMessage("LibrarySection","CopyLibrarySurveyTitle"),width:"auto",height:"auto",closeButton:!0,buttons:[{icon:"cancel",text:window.getMessage("SiteWide","Cancel"),click:"SurveyLibrary.cancelSurveyCopy",className:"negative"},{icon:"check",text:window.getMessage("SiteWide","Copy"),click:"SurveyLibrary.saveSurveyCopy",className:"positive"}]}).setContent(s),new window.Ajax.Request(t.a.getAjaxURL("SetupCopyLibrarySurvey",null,{LibraryID:n.a.activeLibraryId}),{parameters:{sid:e},onSuccess:function(e){var i=e.responseText.evalJSON(),r=i.Accounts,t=i.Categories,n=i.Libraries,o=[],s=window.QBuilder("option");o.push(s);var l=[];for(var d in r)s=window.QBuilder("option",{value:"account#"+d},r[d]),l.push(s);var c=window.QBuilder("optgroup",{label:window.getMessage("LibrarySection","CopyToAnAccount")},l);o.push(c);var u=[];for(var w in n)s=window.QBuilder("option",{value:"library#"+w},n[w]),u.push(s);var p=window.QBuilder("optgroup",{label:window.getMessage("LibrarySection","CopyToALibrary")},u);o.push(p);var y=window.QBuilder("select",{name:"destination"},o);a.observe(y,"change",function(e){e=e||window.event;var i=a.element(e);if("library"==i.value.split("#")[0]){window.$("CopyLibraryCategoryRow").show();var r=i.value.split("#")[1],n=[],o=t[r],l=!1;for(var d in o)"Unassigned"==d&&(l=!0),s=window.QBuilder("option",{value:d},d),n.push(s);if(!l){var c=window.QBuilder("option",{selected:!0,value:"Unassigned"},window.getMessage("LibrarySection","Unassigned"));n.push(c)}var u=window.QBuilder("select",{name:"category",id:"CopyLibrarySurveyCategory"},n);window.$("CopyLibrarySurveyCategoryContainer").innerHTML="",window.$("CopyLibrarySurveyCategoryContainer").appendChild(u),window.QComboBox.replaceSelect(u,{autoComplete:!0})}else window.$("CopyLibraryCategoryRow").hide()}),window.$("DestinationSelectContainer").appendChild(y)}})},saveSurveyCopy:function(){var e=window.$("CategorySelector"),i=void 0;e&&(i=e.value);var r=window.$("copyLibrarySurveyForm").serialize(!0);if(""!=r.destination){var o=this;new window.Ajax.Request(t.a.getAjaxURL("saveLibrarySurveyCopy",null,{LibraryID:n.a.activeLibraryId}),{parameters:r,onSuccess:function(e){window.Q_Window.closeWindow("LibrarySurveyCopy"),i?(o.loadSurveys(i),o.updateCategorySelector(i)):window.SurveyLibraryRefresh.reloadAllElements()}})}},cancelSurveyCopy:function(){window.Q_Window.closeWindow("LibrarySurveyCopy")},copySurveyToLibrary:function(){var e=window.SurveyLibrary.SurveyCategories,i=window.$("CategorySelector").value,r=[],o=!1,s=!1;for(var l in e){"Unassigned"==l&&(o=!0);var d=window.QBuilder("option",{value:l},l);l==i&&(d.setAttribute("selected","selected"),s=!0),r.push(d)}if(!o){var c=window.QBuilder("option",{value:"Unassigned"},window.getMessage("LibrarySection","Unassigned"));s||c.setAttribute("selected","selected"),r.push(c)}var u=window.QBuilder("select",{id:"LibrarySurveyCategory",name:"category",className:"input"},r),w=window.QBuilder("tr",{id:"CopyToLibrarySourceRow"},[window.QBuilder("td",{className:"left"},window.getMessage("EditSection","SourceSurvey")),window.QBuilder("td",{},[window.QBuilder("div",{id:"CopyToLibrarySourceContainer"})])]),p=window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","SurveyName")),window.QBuilder("td",{},[window.QBuilder("input",{id:"CopyToLibrarySurveyName",name:"surveyname",type:"text",className:"TextBox"})])]),y=window.QBuilder("tr",{id:"CopyToLibraryCategoryRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Category")),window.QBuilder("td",{},[window.QBuilder("div",{id:"CopyToLibraryCategoryContainer",className:"categoryInputContainer"},[u])])]),v=window.QBuilder("form",{id:"copyToLibraryForm"},[window.QBuilder("table",{},[window.QBuilder("tbody",{},[w,y,p])])]);new window.Q_Window({id:"LibrarySurveyImport",title:window.getMessage("LibrarySection","CopySurveyText"),width:"auto",height:"auto",closeButton:!0,buttons:[{icon:"cancel",text:window.getMessage("SiteWide","Cancel"),click:"SurveyLibrary.cancelSurveyCopyTo",className:"negative"},{icon:"check",text:window.getMessage("SiteWide","Copy"),click:"SurveyLibrary.saveSurveyCopyTo",className:"positive"}]}).setContent(v),window.QComboBox.replaceSelect(u,{autoComplete:!0}),new window.Ajax.Request(t.a.getAjaxURL("SetupCopySurveyToLibrary",null,{LibraryID:n.a.activeLibraryId}),{parameters:{},onSuccess:function(e){var i=e.responseText.evalJSON(),r=i.Surveys,t=[],n=window.QBuilder("option");t.push(n);for(var o in r)n=window.QBuilder("option",{value:o},r[o]),t.push(n);var s=window.QBuilder("select",{name:"sourcesurvey"},t);a.observe(s,"change",function(e){e=e||window.event;var i=a.element(e),r=i.options[i.selectedIndex].innerHTML;window.$("CopyToLibrarySurveyName").value=r}),window.$("CopyToLibrarySourceContainer").innerHTML="",window.$("CopyToLibrarySourceContainer").appendChild(s)}})},saveSurveyCopyTo:function(){var e=window.$("CategorySelector").value,i=window.$("copyToLibraryForm").serialize(!0);if(""!=i.destination){var r=this;new window.Ajax.Request(t.a.getAjaxURL("saveLibrarySurveyCopyTo",null,{LibraryID:n.a.activeLibraryId}),{parameters:i,onSuccess:function(i){window.Q_Window.closeWindow("LibrarySurveyImport"),r.loadSurveys(e),r.updateCategorySelector(e)}})}},cancelSurveyCopyTo:function(){window.Q_Window.closeWindow("LibrarySurveyImport")},editSurvey:function(e){o.a.editLibrarySurvey(e)},translateSurvey:function(e){o.a.translateLibrarySurvey(e)}},window.BlockLibrary={init:function(){window.BlockLibrary.loadBlocks(),window.BlockLibrary.updateCategorySelector(),new window.Form.Element.Observer("BlockSearchInput",1,window.BlockLibrary.loadBlocksOnChange),a.observe("BlockSearchInput","keypress",window.LibraryGlobal.stopEnter)},loadBlocksOnChange:function(){var e=window.$("CategorySelector").value,i=window.$("BlockSearchInput").value;window.$("BlockSearchInput").hasClassName("AutoClearMessage")&&(i=""),window.BlockLibrary.loadBlocks(e,i)},loadBlocks:function(e,i){var r="";void 0!=i&&(r=i);var o=window.$("AllowUpload").value;void 0==e&&(e="All"),new window.Ajax.Request(t.a.getAjaxURL("GetLibraryBlocks",null,{LibraryID:n.a.activeLibraryId}),{parameters:{category:e,search:r},onSuccess:function(e){if(""!=e.responseText){var i=e.responseText.evalJSON(),r=[];for(var t in i){var n=[],a=i[t],s=window.QBuilder("div",{className:"categorytitle"},t);if(n.push(s),!(a instanceof Array)){var l=[];for(var d in a){var c=a[d],u={title:window.getMessage("LibrarySection","DeleteLibraryBlock"),strong:!1,deleteButtonText:window.getMessage("SiteWide","Delete"),deleteMessage:window.getMessage("LibrarySection","DeleteLibraryBlockConfirm",c),deleteCallBackParameters:{ajaxAction:"DeleteLibraryBlock",ajaxParameters:{blockID:d},ajaxOnComplete:"BlockLibrary.loadBlocksOnChange"}},w=window.QBuilder("td",{className:"icon"},[window.QBuilder("div",{className:"iconContainer",clickcallback:"BlockLibrary.viewBlock",p1:d,p2:a[d]})]),p=window.QBuilder("td",{className:"description",clickcallback:"BlockLibrary.viewBlock",p1:d,p2:a[d]},c),y="";"1"==window.$("AllowEdit").value&&(y=window.QBuilder("td",{className:"edit"},[window.QBuilder("a",{className:"iconContainer",clickcallback:"BlockLibrary.editBlock",p1:d,p2:a[d]},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Edit"))])]));var v="";"1"==window.$("AllowTranslate").value&&(v=window.QBuilder("td",{className:"translate"},[window.QBuilder("a",{className:"iconContainer",clickcallback:"BlockLibrary.translateBlock",p1:d,p2:a[d]},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Translate"))])]));var g=window.QBuilder("td",{className:"view"},[window.QBuilder("a",{className:"iconContainer",clickcallback:"BlockLibrary.viewBlock",p1:d,p2:a[d]},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","View"))])]),b=window.QBuilder("td",{className:"copy"},[window.$("AllowCopy").value?window.QBuilder("a",{className:"iconContainer",clickcallback:"BlockLibrary.copyBlock",p1:d,p2:a[d],p3:t},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Copy"))]):window.QBuilder("a",{className:"iconContainer disabled"},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Copy"))])]),m=window.QBuilder("td",{className:"options"},[window.$("AllowDelete").value?window.QBuilder("a",{className:"iconContainer",clickcallback:"BlockLibrary.BlockOptions",p1:d,p2:a[d],p3:t},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Options"))]):window.QBuilder("a",{className:"iconContainer disabled"},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Options"))])]),f=window.QBuilder("td",{className:"delete"},[window.$("AllowDelete").value?window.QBuilder("a",{className:"iconContainer",clickcallback:"QualtricsCPTools.showDeleteConfirmation",p1:Object.toJSON(u)},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Delete"))]):window.QBuilder("a",{className:"iconContainer disabled"},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Delete"))])]),S=window.QBuilder("tr",{id:"row_"+d,className:"row"},[w,p,y,v,g,m,b,f]);l.push(S)}var h=window.QBuilder("table",{},[window.QBuilder("tbody",{},l)]);n.push(h)}var C=window.QBuilder("div",{className:"categorycontainer"},n);r.push(C)}var L=window.QBuilder("div",{},r);window.$("Blocks").innerHTML="",window.$("Blocks").appendChild(L),window.$("Blocks").setStyle({display:"block"})}else{window.$("Blocks").innerHTML="";var Q=window.QBuilder("div",{className:"NoSurveyMessage"}),B=window.getMessage("LibrarySection","CurrentlyNoBlocks")+" "+(o?'<a clickcallback="BlockLibrary.copyBlockToLibrary">'+window.getMessage("LibrarySection","ClickToCopyBlock")+"</a>":"");Q.innerHTML=B,window.$("Blocks").appendChild(Q)}}})},BlockOptions:function(e,i,r){var t=window.BlockLibrary.BlockCategories,n=[],o=!1,a=!1;for(var s in t){"Unassigned"==s&&(o=!0);var l=window.QBuilder("option",{value:s},s);s==r&&(l.setAttribute("selected","selected"),a=!0),n.push(l)}if(!o){var d=window.QBuilder("option",{value:"Unassigned"},window.getMessage("LibrarySection","Unassigned"));a||d.setAttribute("selected","selected"),n.push(d)}var c=window.QBuilder("select",{id:"LibrarySurveyCategory",name:"category",className:"input"},n),u=window.QBuilder("form",{id:"SurveyLibraryOptionsForm"},[window.QBuilder("input",{type:"hidden",name:"bid",value:e}),window.QBuilder("table",{},[window.QBuilder("tbody",{},[window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Category")),window.QBuilder("td",{},[window.QBuilder("div",{className:"categoryInputContainer"},[c])])]),window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Description")),window.QBuilder("td",{},[window.QBuilder("div",{},[window.QBuilder("input",{type:"text",name:"description",value:i,className:"input TextBox"})])])])])])]);new window.Q_Window({id:"LibraryBlockOptions",title:window.getMessage("LibrarySection","LibraryBlockOptions"),width:"auto",height:"auto",closeButton:!0,buttons:[{icon:"cancel",text:window.getMessage("SiteWide","Cancel"),click:"BlockLibrary.cancelBlockOptions",className:"negative"},{icon:"check",text:window.getMessage("SiteWide","Save"),click:"BlockLibrary.saveBlockOptions",className:"positive"}]}).setContent(u),window.QComboBox.replaceSelect(c,{autoComplete:!0})},cancelBlockOptions:function(){window.Q_Window.closeWindow("LibraryBlockOptions")},saveBlockOptions:function(){var e=window.$("CategorySelector").value,i=window.$("SurveyLibraryOptionsForm").serialize(!0),r=this;new window.Ajax.Request(t.a.getAjaxURL("saveLibraryBlockOptions",null,{LibraryID:n.a.activeLibraryId}),{parameters:i,onSuccess:function(i){window.Q_Window.closeWindow("LibraryBlockOptions"),r.loadBlocks(e),r.updateCategorySelector(e)}})},updateCategorySelector:function(e){new window.Ajax.Request(t.a.getAjaxURL("GetBlockCategories",null,{LibraryID:n.a.activeLibraryId}),{onSuccess:function(i){var r={};""!=i.responseText&&(r=i.responseText.evalJSON()),window.BlockLibrary.BlockCategories=r;var t=[],n=window.QBuilder("option",{value:"All"},window.getMessage("LibrarySection","All"));t.push(n);for(var o in r){var s=window.QBuilder("option",{value:o},o);o==e&&s.setAttribute("selected",""),t.push(s)}var l=window.QBuilder("select",{id:"CategorySelector"},t);a.observe(l,"change",window.BlockLibrary.loadBlocksOnChange),window.$("CategorySelectorContainer").innerHTML="",window.$("CategorySelectorContainer").appendChild(l)}})},editBlock:function(e){o.a.editLibraryBlock(e)},translateBlock:function(e){o.a.translateLibraryBlock(e)},viewBlock:function(e,i,r){r||(r=window.$("LibrarySelect").value);var n="viewBlock_"+e+"_"+r;new window.Q_Window({id:n,title:i,width:"900px",height:"80%",className:"view-block",url:t.a.getAjaxURL("GetBlockPreview",null,{LID:r,BID:e}),iframescrolling:!0,onClose:function(){var e=window.Q_Window.getInstance(n);e.iframe&&e.iframe.parentNode.removeChild(e.iframe)},buttons:[{text:"Close",click:"Q_Window.closeWindow",className:"btn btn-hover"}]})},copyBlock:function(e,i,r){var o=window.QBuilder("tr",{id:"CopyLibraryQuestionCategoryRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Category")),window.QBuilder("td",{},[window.QBuilder("div",{className:"categoryInputContainer",id:"CopyLibraryQuestionCategoryContainer"})])]),s=window.QBuilder("select",{name:"destination"},[window.QBuilder("option",{value:"survey"},window.getMessage("EditSection","ExistingSurvey")),window.QBuilder("option",{value:"library"},window.getMessage("SiteWide","Library"))]),l=window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Destination")),window.QBuilder("td",{},[s])]),d=window.QBuilder("tr",{id:"CopyDialogSurveyRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Survey")),window.QBuilder("td",{},[window.QBuilder("div",{id:"SurveySelectContainer"})])]),c=window.QBuilder("tr",{id:"CopyDialogLibraryRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Library")),window.QBuilder("td",{},[window.QBuilder("div",{id:"LibrarySelectContainer"})])]),u=window.QBuilder("tr",{id:"CopyDialogDescriptionRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Description")),window.QBuilder("td",{},[window.QBuilder("input",{name:"description",type:"text",value:i,className:"TextBox"})])]),w=window.QBuilder("label",{id:"CopyByValueLabel",htmlFor:"CopyByValue"},[window.QBuilder("span",{id:"CopyByValueIcon",className:"ReferenceBlockIcon"})]);window.$(w).insert(window.getMessage("LibrarySection","OneTimeCopy"));var p=window.QBuilder("label",{id:"CopyByReferenceLabel",htmlFor:"CopyByReference"},[window.QBuilder("span",{id:"CopyByReferenceIcon",className:"ReferenceBlockIcon"})]);window.$(p).insert(window.getMessage("LibrarySection","Reference"));var y=window.QBuilder("div",{id:"CopyAsReferenceDiv"},[window.QBuilder("span",{id:"CopyBlockTitle"},window.getMessage("LibrarySection","CopyBlockTitle")),window.QBuilder("div",{className:"CopyBlockBy"},[window.QBuilder("input",{id:"CopyByValue",type:"radio",name:"CopyBlockBy",value:"Value",checked:"true"}),w]),window.QBuilder("div",{className:"CopyBlockBy"},[window.QBuilder("input",{id:"CopyByReference",type:"radio",name:"CopyBlockBy",value:"Reference"}),p])]),v=window.QBuilder("div",{id:"popupError",className:"popupError"});window.$(v).setStyle({display:"none"});var g=window.QBuilder("form",{id:"copyLibraryQuestionForm"},[v,window.QBuilder("input",{name:"bid",type:"hidden",value:e}),window.QBuilder("table",{style:"margin-bottom:12px;"},[window.QBuilder("tbody",{},[l,c,d,o,u])]),y]);window.$(o).setStyle({display:"none"}),window.$(c).setStyle({display:"none"}),window.$(u).setStyle({display:"none"}),a.observe(s,"change",function(e){e=e||window.event;var i=a.element(e),r=i.value;"library"==r?(window.$("CopyLibraryQuestionCategoryRow").show(),window.$("CopyDialogLibraryRow").show(),window.$("CopyDialogSurveyRow").hide(),window.$("CopyDialogDescriptionRow").show(),window.$("CopyAsReferenceDiv").hide()):"survey"==r&&(window.$("CopyLibraryQuestionCategoryRow").hide(),window.$("CopyDialogLibraryRow").hide(),window.$("CopyDialogSurveyRow").show(),window.$("CopyDialogDescriptionRow").hide(),window.$("CopyAsReferenceDiv").show())}),new window.Q_Window({id:"LibraryBlockCopy",title:window.getMessage("LibrarySection","CopyLibraryBlockTitle"),width:"auto",height:"auto",closeButton:!0,buttons:[{icon:"cancel",text:window.getMessage("SiteWide","Cancel"),click:"BlockLibrary.cancelBlockCopy",className:"negative"},{id:"saveBlockCopyButton",icon:"check",text:window.getMessage("SiteWide","Save"),click:"BlockLibrary.saveBlockCopy",className:"positive"}]}).setContent(g),new window.Ajax.Request(t.a.getAjaxURL("SetupCopyLibraryBlock",null,{LibraryID:n.a.activeLibraryId}),{parameters:{bid:e},onSuccess:function(e){var i=e.responseText.evalJSON(),r=i.Categories,t=i.Libraries,n=i.Surveys,o=[],s=window.QBuilder("option");o.push(s);for(var l in n)s=window.QBuilder("option",{value:l},n[l]),o.push(s);var d=window.QBuilder("select",{name:"destinationsurvey"},o);window.$("SurveySelectContainer").appendChild(d);var c=[];s=window.QBuilder("option"),c.push(s);for(var u in t)s=window.QBuilder("option",{value:u},t[u]),c.push(s);var w=window.QBuilder("select",{name:"library"},c);window.$("LibrarySelectContainer").appendChild(w),a.observe(w,"change",function(e){e=e||window.event;var i=a.element(e),t=i.value;if(window.$("CopyLibraryQuestionCategoryContainer").innerHTML="",""!=t){var n=[],o=r[t],l=!1;for(var d in o)s=window.QBuilder("option",{value:d},d),n.push(s),"Unassigned"==d&&(l=!0,s.setAttribute("selected","selected"));if(!l){var c=window.QBuilder("option",{selected:"selected",value:"Unassigned"},window.getMessage("LibrarySection","Unassigned"));n.push(c)}var u=window.QBuilder("select",{name:"category",id:"CopyLibraryQuestionCategory"},n);window.$("CopyLibraryQuestionCategoryContainer").appendChild(u),window.QComboBox.replaceSelect(u,{autoComplete:!0})}})}})},cancelBlockCopy:function(){window.Q_Window.closeWindow("LibraryBlockCopy")},saveBlockCopy:function(){var e=window.Q_Window.getInstance("LibraryBlockCopy");e.busifyButton("saveBlockCopyButton",window.getMessage("Javascript","Saving"));var i=window.$("CategorySelector"),r=void 0;i&&(r=i.value);var n=window.$("copyLibraryQuestionForm").serialize(!0),o="saveLibraryBlockCopy",a="";if("survey"==n.destination?""==n.destinationsurvey?a=window.getMessage("SiteWide","SurveySelectionBox"):"Reference"==n.CopyBlockBy&&(o="AddReferenceBlockToSurvey",n.SurveyID=n.destinationsurvey,n.BlockID=n.bid,window.Qualtrics.Library?n.LibraryID=window.Qualtrics.Library.activeLibraryID:n.LibraryID=window.SurveyLibraryRefresh.getStoredActiveLibrary()):"library"==n.destination&&(""==n.library&&(a="Please Select a library"),""==n.category&&(a="Please Select a Category")),""==a&&""==n.description&&(a="Please Enter a Description"),""==a&&""==n.bid&&(a="Error"),""==a){var s=this;new window.Ajax.Request(t.a.getAjaxURL(o),{parameters:n,onSuccess:function(e){window.Q_Window.closeWindow("LibraryBlockCopy"),r?(s.loadBlocks(r),s.updateCategorySelector(r),s.updateCategorySelector(r)):window.SurveyLibraryRefresh.reloadAllElements()}})}else{var l=window.$("popupError");l&&(l.show(),l.innerHTML=a),e.unbusifyButton("saveBlockCopyButton")}},copyBlockToLibrary:function(){this.copyToLibrary(!0,"CopyBlockText","SourceBlock","getBlocksForSurvey","saveBlockCopyTo")},copyToLibrary:function(e,i,r,o,s){var l=window.BlockLibrary.BlockCategories,d=window.$("CategorySelector").value,c=[],u=!1,w=!1,p=void 0;for(var y in l){var v=window.QBuilder("option",{value:y},y);y==d&&(v.setAttribute("selected","selected"),w=!0),c.push(v),"Unassigned"==y&&(u=!0,p=v)}u||(p=window.QBuilder("option",{value:"Unassigned"},window.getMessage("LibrarySection","Unassigned")),c.push(p)),w||p.setAttribute("selected","selected");var g=window.QBuilder("div",{id:"popupError",className:"popupError"});window.$(g).setStyle({display:"none"});var b=window.QBuilder("select",{id:"LibraryQuestionCategory",name:"category",className:"input"},c),m=window.QBuilder("tr",{id:"CopyToLibrarySourceSurveyRow"},[window.QBuilder("td",{className:"left"},window.getMessage("EditSection","SourceSurvey")),window.QBuilder("td",{},[window.QBuilder("div",{id:"CopyToLibrarySourceSurveyContainer"})])]),f=window.QBuilder("tr",{id:"CopyToLibrarySourceQuestionRow"},[window.QBuilder("td",{className:"left"},window.getMessage("EditSection",r)),window.QBuilder("td",{},[window.QBuilder("div",{id:"CopyToLibrarySourceContainer"})])]),S="";e&&(S=window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Description")),window.QBuilder("td",{},[window.QBuilder("input",{id:"CopyToLibraryDescription",name:"description",type:"text",className:"TextBox"})])]));var h=window.QBuilder("tr",{id:"CopyToLibraryCategoryRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Category")),window.QBuilder("td",{},[window.QBuilder("div",{id:"CopyToLibraryCategoryContainer",className:"categoryInputContainer"},[b])])]),C=window.QBuilder("form",{id:"copyToLibraryForm"},[g,window.QBuilder("table",{},[window.QBuilder("tbody",{},[m,f,h,S])])]);new window.Q_Window({id:"LibraryBlockImport",title:window.getMessage("LibrarySection",i),width:"auto",height:"auto",closeButton:!0,buttons:[{icon:"cancel",text:window.getMessage("SiteWide","Cancel"),click:"BlockLibrary.cancelBlockCopyTo",className:"negative"},{id:"copyBlockToLibraryButton",icon:"check",text:window.getMessage("SiteWide","Copy"),click:"BlockLibrary."+s,className:"positive"}]}).setContent(C),window.QComboBox.replaceSelect(b,{autoComplete:!0}),new window.Ajax.Request(t.a.getAjaxURL("SetupCopyQuestionToLibrary",null,{LibraryID:n.a.activeLibraryId}),{parameters:{},onSuccess:function(i){var r=i.responseText.evalJSON(),s=r.Surveys,l=[],d=window.QBuilder("option");l.push(d);for(var c in s)d=window.QBuilder("option",{value:c},s[c]),l.push(d);var u=window.QBuilder("select",{name:"sourcesurvey"},l);a.observe(u,"change",function(i){e&&(window.$("CopyToLibraryDescription").value=""),window.$("CopyToLibrarySourceContainer").appendChild(window.QAjaxWaiter.showSmallRing()),i=i||window.event;var r=a.element(i),s=r.value;""!=s?new window.Ajax.Request(t.a.getAjaxURL(o,null,{LibraryID:n.a.activeLibraryId}),{parameters:{sid:s},onSuccess:function(i){var r=i.responseText.evalJSON(),t=[];if(d=window.QBuilder("option"),t.push(d),!(r instanceof Array))for(var n in r)d=window.QBuilder("option",{value:n},r[n]),t.push(d);var o=window.QBuilder("select",{name:"copy"},t);window.$("CopyToLibrarySourceContainer").innerHTML="",window.$("CopyToLibrarySourceContainer").appendChild(o),e&&a.observe(o,"change",function(e){var i=a.element(e),r=i.options[i.selectedIndex].innerHTML;window.$("CopyToLibraryDescription").value=r})}}):window.$("CopyToLibrarySourceContainer").innerHTML=""}),window.$("CopyToLibrarySourceSurveyContainer").innerHTML="",window.$("CopyToLibrarySourceSurveyContainer").appendChild(u)}})},saveBlockCopyTo:function(){var e=window.Q_Window.getInstance("LibraryBlockImport");e.busifyButton("copyBlockToLibraryButton",window.getMessage("Javascript","Copying"));var i=window.$("LibrarySelect").value,r=window.$("CategorySelector").value,o=window.$("copyToLibraryForm").serialize(!0),a={};a.SurveyID=o.sourcesurvey,a.BlockID=o.copy,a.BlockName=o.description,a.Category=o.categoryText,a.LibraryID=i;var s="";if(a.SurveyID?a.BlockID?a.BlockName?a.Category?a.LibraryID||(s="Internal Error"):s="Please Select A Category":s="Please Insert A Description":s="Please Select A Block":s="Please Select A Survey",""==s){var l=this;new window.Ajax.Request(t.a.getAjaxURL("copySurveyBlockToLibrary",null,{LibraryID:n.a.activeLibraryId}),{parameters:a,onSuccess:function(e){window.Q_Window.closeWindow("LibraryBlockImport"),l.loadBlocks(r),l.updateCategorySelector(r)}})}else window.$("popupError").show(),window.$("popupError").innerHTML=s,e.unbusifyButton("copyBlockToLibraryButton")},cancelBlockCopyTo:function(){window.Q_Window.closeWindow("LibraryBlockImport")}},window.QuestionLibrary={init:function(){window.QuestionLibrary.loadQuestions(),window.QuestionLibrary.updateCategorySelector(),new window.Form.Element.Observer("QuestionSearchInput",1,window.QuestionLibrary.searchQuestions),a.observe("QuestionSearchInput","keypress",window.LibraryGlobal.stopEnter)},searchQuestions:function(){var e=window.$("CategorySelector").value,i=window.$("QuestionSearchInput").value;window.$("QuestionSearchInput").hasClassName("AutoClearMessage")&&(i=""),window.QuestionLibrary.loadQuestions(e,i)},loadQuestionsOnChange:function(){window.QuestionLibrary.searchQuestions()},loadQuestions:function(e,i){var r=window.$("AllowUpload").value,o="";void 0!=i&&(o=i),void 0==e&&(e="All"),new window.Ajax.Request(t.a.getAjaxURL("GetLibraryQuestions",null,{LibraryID:n.a.activeLibraryId}),{parameters:{category:e,search:o},onSuccess:function(e){if(""!=e.responseText){var i=e.responseText.evalJSON(),t=[];for(var n in i){var o=[],a=i[n],s=window.QBuilder("div",{className:"categorytitle"},n);if(o.push(s),!(a instanceof Array)){var l=[];for(var d in a){var c=a[d],u={title:window.getMessage("LibrarySection","DeleteLibraryQuestion"),strong:!1,deleteButtonText:window.getMessage("SiteWide","Delete"),deleteMessage:window.getMessage("LibrarySection","DeleteLibraryQuestionConfirm",c),deleteCallBackParameters:{ajaxAction:"deleteLibraryQuestion",ajaxParameters:{qid:d},ajaxOnComplete:"QuestionLibrary.loadQuestionsOnChange"}},w=window.QBuilder("td",{className:"icon"},[window.QBuilder("div",{className:"iconContainer",clickcallback:"QuestionLibrary.viewQuestion",p1:d,p2:a[d]})]),p=window.QBuilder("td",{className:"description",clickcallback:"QuestionLibrary.viewQuestion",p1:d,p2:a[d]},c),y=window.QBuilder("td",{className:"view"},[window.QBuilder("a",{className:"iconContainer",clickcallback:"QuestionLibrary.viewQuestion",p1:d,p2:a[d]},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","View"))])]),v=window.QBuilder("td",{className:"options"},[window.$("AllowDelete").value?window.QBuilder("a",{className:"iconContainer",clickcallback:"QuestionLibrary.questionOptions",p1:d,p2:a[d],p3:n},[window.QBuilder("span",{className:"text"},window.getMessage("SurveyCreateWizard","PanelNameQuestionOptions"))]):window.QBuilder("a",{className:"iconContainer disabled"},[window.QBuilder("span",{className:"text"},window.getMessage("SurveyCreateWizard","PanelNameQuestionOptions"))])]),g=window.QBuilder("td",{className:"copy"},[window.$("AllowCopy").value?window.QBuilder("a",{className:"iconContainer",clickcallback:"QuestionLibrary.copyQuestion",p1:d,p2:a[d],p3:n},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Copy"))]):window.QBuilder("a",{className:"iconContainer disabled"},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Copy"))])]),b=window.QBuilder("td",{className:"delete"},[window.$("AllowDelete").value?window.QBuilder("a",{className:"iconContainer",clickcallback:"QualtricsCPTools.showDeleteConfirmation",p1:Object.toJSON(u)},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Delete"))]):window.QBuilder("a",{className:"iconContainer disabled"},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Delete"))])]),m=window.QBuilder("tr",{id:"row_"+d,className:"row"},[w,p,y,v,g,b]);l.push(m)}var f=window.QBuilder("table",{},[window.QBuilder("tbody",{},l)]);o.push(f)}var S=window.QBuilder("div",{className:"categorycontainer"},o);t.push(S)}var h=window.QBuilder("div",{},t);window.$("Questions").innerHTML="",window.$("Questions").appendChild(h),window.$("Questions").setStyle({display:"block"})}else{window.$("Questions").innerHTML="";var C=window.QBuilder("div",{className:"NoSurveyMessage"}),L=window.getMessage("LibrarySection","CurrentlyNoQuestions")+" "+(r?'<a clickcallback="QuestionLibrary.copyQuestionToLibrary">'+window.getMessage("LibrarySection","ClickToCopyQuestion")+"</a>":"");C.innerHTML=L,window.$("Questions").appendChild(C)}}})},updateCategorySelector:function(e){new window.Ajax.Request(t.a.getAjaxURL("GetQuestionCategories",null,{LibraryID:n.a.activeLibraryId}),{onSuccess:function(i){var r={};""!=i.responseText&&(r=i.responseText.evalJSON()),window.QuestionLibrary.QuestionCategories=r;var t=[],n=window.QBuilder("option",{value:"All"},window.getMessage("LibrarySection","All"));t.push(n);for(var o in r){var s=window.QBuilder("option",{value:o},o);o==e&&s.setAttribute("selected",""),t.push(s)}var l=window.QBuilder("select",{id:"CategorySelector"},t);a.observe(l,"change",window.QuestionLibrary.loadQuestionsOnChange),window.$("CategorySelectorContainer").innerHTML="",window.$("CategorySelectorContainer").appendChild(l)}})},viewQuestion:function(e,i,r){r||(r=window.$("LibrarySelect").value),this.questionPreviewPopup=new window.QuestionPreviewPopup({title:i,width:900,height:500,questionId:e,libraryId:r,iframescrolling:!0}),this.questionPreviewPopup.clearContent(),this.questionPreviewPopup.show()},questionOptions:function(e,i,r){var t=window.QuestionLibrary.QuestionCategories,n=[],o=!1,a=!1;for(var s in t){"Unassigned"==s&&(o=!0);var l=window.QBuilder("option",{value:s},s);s==r&&(l.setAttribute("selected","selected"),a=!0),n.push(l)}if(!o){var d=window.QBuilder("option",{value:"Unassigned"},window.getMessage("LibrarySection","Unassigned"));a||d.setAttribute("selected","selected"),n.push(d)}var c=window.QBuilder("select",{id:"LibraryQuestionCategory",name:"category",className:"input"},n),u=window.QBuilder("form",{id:"QuestionLibraryOptionsForm"},[window.QBuilder("input",{type:"hidden",name:"qid",value:e}),window.QBuilder("table",{},[window.QBuilder("tbody",{},[window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Category")),window.QBuilder("td",{},[window.QBuilder("div",{className:"categoryInputContainer"},[c])])]),window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Description")),window.QBuilder("td",{},[window.QBuilder("div",{},[window.QBuilder("input",{type:"text",name:"description",value:i,className:"input TextBox"})])])])])])]),w=new window.Q_Window({id:"LibraryQuestionOptions",title:window.getMessage("LibrarySection","LibraryQuestionOptions"),width:"auto",height:"auto",closeButton:!0,buttons:[{icon:"cancel",text:window.getMessage("SiteWide","Cancel"),click:"QuestionLibrary.cancelQuestionOptions",className:"negative"},{icon:"check",text:window.getMessage("SiteWide","Save"),click:"QuestionLibrary.saveQuestionOptions",className:"positive"}]});w.setContent(u),window.QComboBox.replaceSelect(c,{autoComplete:!0}),w.center()},cancelQuestionOptions:function(){window.Q_Window.closeWindow("LibraryQuestionOptions")},saveQuestionOptions:function(){var e=window.$("CategorySelector").value,i=window.$("QuestionLibraryOptionsForm").serialize(!0),r=this;new window.Ajax.Request(t.a.getAjaxURL("saveLibraryQuestionOptions",null,{LibraryID:n.a.activeLibraryId}),{parameters:i,onSuccess:function(i){window.Q_Window.closeWindow("LibraryQuestionOptions"),r.loadQuestions(e),r.updateCategorySelector(e)}})},copyQuestion:function(e,i,r){var o=window.QBuilder("tr",{id:"CopyLibraryQuestionCategoryRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Category")),window.QBuilder("td",{},[window.QBuilder("div",{className:"categoryInputContainer",id:"CopyLibraryQuestionCategoryContainer"})])]),s=window.QBuilder("select",{name:"destination"},[window.QBuilder("option",{value:"survey"},window.getMessage("EditSection","ExistingSurvey")),window.QBuilder("option",{value:"library"},window.getMessage("SiteWide","Library"))]),l=window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Destination")),window.QBuilder("td",{},[s])]),d=window.QBuilder("tr",{id:"CopyDialogSurveyRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Survey")),window.QBuilder("td",{},[window.QBuilder("div",{id:"SurveySelectContainer"})])]),c=window.QBuilder("tr",{id:"CopyDialogLibraryRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Library")),window.QBuilder("td",{},[window.QBuilder("div",{id:"LibrarySelectContainer"})])]),u=window.QBuilder("tr",{id:"CopyDialogDescriptionRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Description")),window.QBuilder("td",{},[window.QBuilder("input",{name:"description",type:"text",value:i,className:"TextBox"})])]),w=window.QBuilder("form",{id:"copyLibraryQuestionForm"},[window.QBuilder("input",{name:"qid",type:"hidden",value:e}),window.QBuilder("table",{},[window.QBuilder("tbody",{},[l,c,d,o,u])])]);window.$(o).setStyle({display:"none"}),window.$(c).setStyle({display:"none"}),a.observe(s,"change",function(e){e=e||window.event;var i=a.element(e),r=i.value;"library"==r?(window.$("CopyLibraryQuestionCategoryRow").show(),window.$("CopyDialogLibraryRow").show(),window.$("CopyDialogSurveyRow").hide()):"survey"==r&&(window.$("CopyLibraryQuestionCategoryRow").hide(),window.$("CopyDialogLibraryRow").hide(),window.$("CopyDialogSurveyRow").show())}),new window.Q_Window({id:"LibraryQuestionCopy",title:window.getMessage("LibrarySection","CopyLibraryQuestionTitle"),width:"auto",height:"auto",closeButton:!0,buttons:[{icon:"cancel",text:window.getMessage("SiteWide","Cancel"),click:"QuestionLibrary.cancelQuestionCopy",className:"negative"},{icon:"check",text:window.getMessage("SiteWide","Copy"),click:"QuestionLibrary.saveQuestionCopy",className:"positive"}]}).setContent(w),new window.Ajax.Request(t.a.getAjaxURL("SetupCopyLibraryQuestion",null,{LibraryID:n.a.activeLibraryId}),{parameters:{qid:e},onSuccess:function(e){var i=e.responseText.evalJSON(),r=i.Categories,t=i.Libraries,n=i.Surveys,o=[],s=window.QBuilder("option");o.push(s);for(var l in n)s=window.QBuilder("option",{value:l},n[l]),o.push(s);var d=window.QBuilder("select",{name:"destinationsurvey"},o);window.$("SurveySelectContainer").appendChild(d);var c=[];s=window.QBuilder("option"),c.push(s);for(var u in t)s=window.QBuilder("option",{value:u},t[u]),c.push(s);var w=window.QBuilder("select",{name:"library"},c);window.$("LibrarySelectContainer").appendChild(w),a.observe(w,"change",function(e){e=e||window.event;var i=a.element(e),t=i.value;if(window.$("CopyLibraryQuestionCategoryContainer").innerHTML="",""!=t){var n=[],o=r[t],l=!1;for(var d in o)s=window.QBuilder("option",{value:d},d),n.push(s),"Unassigned"==d&&(l=!0,s.setAttribute("selected","selected"));if(!l){var c=window.QBuilder("option",{selected:"selected",value:"Unassigned"},window.getMessage("LibrarySection","Unassigned"));n.push(c)}var u=window.QBuilder("select",{name:"category",id:"CopyLibraryQuestionCategory"},n);window.$("CopyLibraryQuestionCategoryContainer").appendChild(u),window.QComboBox.replaceSelect(u,{autoComplete:!0})}})}})},cancelQuestionCopy:function(){window.Q_Window.closeWindow("LibraryQuestionCopy")},saveQuestionCopy:function(){var e=window.$("CategorySelector"),i=void 0;e&&(i=e.value);var r=window.$("copyLibraryQuestionForm").serialize(!0),o=!0;if(""==r.description&&(o=!1),""==r.qid&&(o=!1),"survey"==r.destination?""==r.destinationsurvey&&(o=!1):"library"==r.destination&&(""==r.library&&(o=!1),""==r.category&&(o=!1)),o){var a=this;new window.Ajax.Request(t.a.getAjaxURL("saveLibraryQuestionCopy",null,{LibraryID:n.a.activeLibraryId}),{parameters:r,onSuccess:function(e){window.Q_Window.closeWindow("LibraryQuestionCopy"),i?(a.loadQuestions(i),a.updateCategorySelector(i)):window.SurveyLibraryRefresh.reloadAllElements()}})}},copyQuestionToLibrary:function(){this.copyToLibrary(!0,"CopyQuestionText","SourceQuestion","getQuestionsForSurvey","saveQuestionCopyTo")},copyToLibrary:function(e,i,r,o,s){var l=window.QuestionLibrary.QuestionCategories,d=window.$("CategorySelector").value,c=[],u=!1,w=!1,p=void 0;for(var y in l){var v=window.QBuilder("option",{value:y},y);y==d&&(v.setAttribute("selected","selected"),w=!0),c.push(v),"Unassigned"==y&&(u=!0,p=v)}u||(p=window.QBuilder("option",{value:"Unassigned"},window.getMessage("LibrarySection","Unassigned")),c.push(p)),w||p.setAttribute("selected","selected");var g=window.QBuilder("div",{id:"popupError",className:"popupError"});window.$(g).setStyle({display:"none"});var b=window.QBuilder("select",{id:"LibraryQuestionCategory",name:"category",className:"input"},c),m=window.QBuilder("tr",{id:"CopyToLibrarySourceSurveyRow"},[window.QBuilder("td",{className:"left"},window.getMessage("EditSection","SourceSurvey")),window.QBuilder("td",{},[window.QBuilder("div",{id:"CopyToLibrarySourceSurveyContainer"})])]),f=window.QBuilder("tr",{id:"CopyToLibrarySourceQuestionRow"},[window.QBuilder("td",{className:"left"},window.getMessage("EditSection",r)),window.QBuilder("td",{},[window.QBuilder("div",{id:"CopyToLibrarySourceContainer"})])]),S="";e&&(S=window.QBuilder("tr",{},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Description")),window.QBuilder("td",{},[window.QBuilder("input",{id:"CopyToLibraryDescription",name:"description",type:"text",className:"TextBox"})])]));var h=window.QBuilder("tr",{id:"CopyToLibraryCategoryRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Category")),window.QBuilder("td",{},[window.QBuilder("div",{id:"CopyToLibraryCategoryContainer",className:"categoryInputContainer"},[b])])]),C=window.QBuilder("form",{id:"copyToLibraryForm"},[g,window.QBuilder("table",{},[window.QBuilder("tbody",{},[m,f,h,S])])]);new window.Q_Window({id:"LibraryQuestionImport",title:window.getMessage("LibrarySection",i),width:"auto",height:"auto",closeButton:!0,buttons:[{icon:"cancel",text:window.getMessage("SiteWide","Cancel"),click:"QuestionLibrary.cancelQuestionCopyTo",className:"negative"},{icon:"check",text:window.getMessage("SiteWide","Copy"),click:"QuestionLibrary."+s,className:"positive"}]}).setContent(C),window.QComboBox.replaceSelect(b,{autoComplete:!0}),new window.Ajax.Request(t.a.getAjaxURL("SetupCopyQuestionToLibrary",null,{LibraryID:n.a.activeLibraryId}),{parameters:{},onSuccess:function(i){var r=i.responseText.evalJSON(),s=r.Surveys,l=[],d=window.QBuilder("option");l.push(d);for(var c in s)d=window.QBuilder("option",{value:c},s[c]),l.push(d);var u=window.QBuilder("select",{name:"sourcesurvey"},l);a.observe(u,"change",function(i){e&&(window.$("CopyToLibraryDescription").value=""),window.$("CopyToLibrarySourceContainer").appendChild(window.QAjaxWaiter.showSmallRing()),i=i||window.event;var r=a.element(i),s=r.value;""!=s?new window.Ajax.Request(t.a.getAjaxURL("",null,{LibraryID:n.a.activeLibraryId})+o,{parameters:{sid:s},onSuccess:function(i){var r=i.responseText.evalJSON(),t=[];if(d=window.QBuilder("option"),t.push(d),!(r instanceof Array))for(var n in r)d=window.QBuilder("option",{value:n},r[n]),t.push(d);var o=window.QBuilder("select",{name:"copy"},t);window.$("CopyToLibrarySourceContainer").innerHTML="",window.$("CopyToLibrarySourceContainer").appendChild(o),e&&a.observe(o,"change",function(e){var i=a.element(e),r=i.options[i.selectedIndex].innerHTML;window.$("CopyToLibraryDescription").value=r})}}):window.$("CopyToLibrarySourceContainer").innerHTML=""}),window.$("CopyToLibrarySourceSurveyContainer").innerHTML="",window.$("CopyToLibrarySourceSurveyContainer").appendChild(u)}})},saveQuestionToLibrary:function(e){var i=this;new window.Ajax.Request(t.a.getAjaxURL("saveLibraryQuestionCopyTo",null,{LibraryID:n.a.activeLibraryId}),{parameters:e,onSuccess:function(r){var t=e.category;i.loadQuestions(t),i.updateCategorySelector(t)}})},errorCheck:function(e){var i="";return e.category||(i+=window.getMessage("LibrarySection","CategoryNotValid")+"<br/>"),e.description&&""!=window.trim(e.description)||(i+=window.getMessage("LibrarySection","DescriptionNotValid")+"<br/>"),e.sourcesurvey||(i+=window.getMessage("LibrarySection","SourceSurveyNotValid")+"<br/>"),e.copy||(i+=window.getMessage("LibrarySection","QuestionNotValid")+"<br/>"),i},saveQuestionCopyTo:function(){var e=window.$("copyToLibraryForm").serialize(!0),i=this.errorCheck(e);""==i?(this.saveQuestionToLibrary(e),window.Q_Window.closeWindow("LibraryQuestionImport")):(window.$("popupError").show(),window.$("popupError").innerHTML=i)},cancelQuestionCopyTo:function(){window.Q_Window.closeWindow("LibraryQuestionImport")}},window.MessageLibrary={init:function(){this.categoryMap=window.MessageEditor.categoryMap},loadMessages:function(e,i){var r=window.$("AllowModify").value,o="";void 0!=i&&(o=i),window.$("MessageSearchInput").hasClassName("AutoClearMessage")&&(o=""),void 0!=e&&""!=e||(e="All"),new window.Ajax.Request(t.a.getAjaxURL("GetLibraryMessages",null,{LibraryID:n.a.activeLibraryId}),{parameters:{category:e,search:o},onSuccess:function(e){if(""!=e.responseText){var i=e.responseText.evalJSON(),t=[];for(var n in i){var o=[],a=i[n],s=window.QBuilder("div",{className:"categorytitle"},window.MessageLibrary.categoryMap[n]);if(o.push(s),!(a instanceof Array)){var l=[];for(var d in a){var c=a[d],u={title:window.getMessage("LibrarySection","DeleteLibraryMessage"),strong:!1,deleteButtonText:window.getMessage("SiteWide","Delete"),deleteMessage:window.getMessage("LibrarySection","DeleteLibraryMessageConfirm",c),deleteCallBackParameters:{ajaxAction:"DeleteLibraryMessage",ajaxParameters:{mid:d},ajaxOnComplete:"MessageLibrary.loadMessagesOnChange"}},w=window.QBuilder("td",{className:"icon "+n},[window.QBuilder("div",{className:"iconContainer",clickcallback:"MessageLibrary.viewMessage",p1:d,p2:a[d]})]),p=window.QBuilder("td",{className:"description",clickcallback:"MessageLibrary.viewMessage",p1:d,p2:a[d]},c),y=window.QBuilder("td",{className:"view"},[window.QBuilder("a",{className:"iconContainer",clickcallback:"MessageLibrary.viewMessage",p1:d,p2:a[d]},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","View"))])]),v=window.QBuilder("td",{className:"edit"},[window.$("AllowModify").value?window.QBuilder("a",{className:"iconContainer",clickcallback:"MessageLibrary.editMessage",p1:d,p2:a[d],p3:n},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Edit"))]):window.QBuilder("a",{className:"iconContainer disabled"},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Edit"))])]),g=window.QBuilder("td",{className:"copy"},[window.QBuilder("a",{className:"iconContainer",clickcallback:"MessageLibrary.copyMessage",p1:d,p2:a[d],p3:n},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Copy"))])]),b=window.QBuilder("td",{className:"translate"},[window.QBuilder("a",{className:"iconContainer",clickcallback:"MessageLibrary.translateMessage",p1:d},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Translate"))])]),m=window.QBuilder("td",{className:"delete"},[window.$("AllowModify").value?window.QBuilder("a",{className:"iconContainer",clickcallback:"QualtricsCPTools.showDeleteConfirmation",p1:Object.toJSON(u)},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Delete"))]):window.QBuilder("a",{className:"iconContainer disabled"},[window.QBuilder("span",{className:"text"},window.getMessage("SiteWide","Delete"))])]),f=window.QBuilder("tr",{id:"row_"+d,className:"row"},[w,p,y,v,g,b,m]);l.push(f)}var S=window.QBuilder("table",{},[window.QBuilder("tbody",{},l)]);o.push(S)}var h=window.QBuilder("div",{className:"categorycontainer"},o);t.push(h)}var C=window.QBuilder("div",{},t);window.$("Messages").innerHTML="",window.$("Messages").appendChild(C),window.$("Messages").setStyle({display:"block"})}else{window.$("Messages").innerHTML="";var L=window.QBuilder("div",{className:"NoSurveyMessage"}),Q=window.getMessage("LibrarySection","CurrentlyNoMessages")+" "+(r?'<a clickcallback="MessageLibrary.editMessage">'+window.getMessage("LibrarySection","ClickToCreateMessage")+"</a>":"");L.innerHTML=Q,window.$("Messages").appendChild(L)}}})},searchMessages:function(e,i){var r=window.$("CategorySelector").value;this.loadMessages(r,i)},updateCategorySelector:function(e){window.MessageLibrary.MessageCategories=window.MessageEditor.categories;var i=[],r=window.QBuilder("option",{value:"All"},window.getMessage("LibrarySection","All"));i.push(r);for(var t in window.MessageLibrary.MessageCategories){var n=window.QBuilder("option",{value:t},window.MessageLibrary.categoryMap[t]);t==e&&n.setAttribute("selected",""),i.push(n)}var o=window.QBuilder("select",{id:"CategorySelector"},i);a.observe(o,"change",window.MessageLibrary.loadMessagesOnChange),window.$("CategorySelectorContainer").innerHTML="",window.$("CategorySelectorContainer").appendChild(o)},loadMessagesOnChange:function(){window.MessageLibrary.loadMessages(window.$("CategorySelector").value,window.$("MessageSearchInput").value)},viewMessage:function(e,i){var r=this;new window.Ajax.Request(t.a.getAjaxURL("getMessageCategory",null,{LibraryID:n.a.activeLibraryId}),{parameters:{mid:e},onSuccess:function(o){var a=o.responseText,s="",l=void 0;"MVD"==a?(l=window.MessageEditor.createBlankVTable(),window.MessageEditor.arrayToTable(e,l,!1)):s=t.a.getAjaxURL("GetMessagePreview",null,{LibraryID:n.a.activeLibraryId,purify:!0,mid:e});var d=new window.Q_Window({id:"ViewMessage",title:i,width:"800px",height:"320px",closeButton:!0,url:s,iframescrolling:!0});void 0!=l&&d.setContent(window.QBuilder("div",{id:"validationMessageContainer"},[l])),r.langMenu=window.QMenu.buildMenuButton("Select Language...","MessageLibrary.buildMenu("+e+")",{className:"SelectMenuButton LangSelect"});var c=window.Q_Window.getInstanceByWindowName("ViewMessage").headerDom,u=window.$(c).down(".Q_WindowCloseSQ");c.innerHTML="",c.appendChild(window.QBuilder("div",{className:"Q_WindowHeaderInner"},[window.QBuilder("h2",{},i),r.langMenu,u]))}})},buildMenu:function(e){return{ajax:{action:"GetMessage",parameters:{messageID:e},preparser:"MessageLibrary.parseTranslateMenu",preparams:{0:e}}}},changeMessageLanguage:function(e,i){var r=this;new window.Ajax.Request(t.a.getAjaxURL("getMessageCategory",null,{LibraryID:n.a.activeLibraryId}),{parameters:{mid:e},onSuccess:function(o){if(window.MessageLibrary.availableLanguages[i]?r.langMenu.callbackNode.innerHTML=window.MessageLibrary.availableLanguages[i]:r.langMenu.callbackNode.innerHTML=window.MessageLibrary.customLanguages[i].DisplayName,"MVD"==o.responseText)r.changeValidationMessageLanguage(e,i);else{var a=t.a.getAjaxURL("GetMessagePreview",null,{LibraryID:n.a.activeLibraryId,mid:e,lang:i,purify:""});window.Q_Window.getInstance("ViewMessage").iframe.src=a}}})},changeValidationMessageLanguage:function(e,i){var r=window.MessageEditor.createBlankVTable();window.MessageEditor.arrayToTable(e,r,!1,i),window.$("validationMessageContainer").innerHTML="",window.$("validationMessageContainer").appendChild(r)},parseTranslateMenu:function(e,i){var r=window.Qualtrics.parseJSON(e),t=[];for(var n in r){var o={display:void 0!=window.MessageLibrary.availableLanguages[n]?window.MessageLibrary.availableLanguages[n]:window.MessageLibrary.customLanguages[n].DisplayName,action:"MessageLibrary.changeMessageLanguage("+i+", "+n+")"};t.push(o)}return t.push({separator:!0}),t.push({display:"Add Translation...",action:"MessageLibrary.translateMessage("+i+")"}),{items:t}},editMessage:function(e,i,r){var t={saved:this.messageSaved.bind(this)};window.MessageEditor.editMessage(e,i,r,t)},messageSaved:function(){var e=window.$("CategorySelector").value;this.loadMessages(e),this.updateCategorySelector(e,window.$("MessageSearchInput").value)},translateMessage:function(e){o.a.translateLibraryMessage(e)},copyMessage:function(e,i,r){var o="";o=window.QBuilder("tr",{id:"CopyLibraryMessageCategoryRow"},[window.QBuilder("td",{className:"left"},window.getMessage("Category")),window.QBuilder("td",{},[window.QBuilder("div",{className:"categoryInputContainer",id:"CopyLibraryMessageCategoryContainer"})])]);var a=window.QBuilder("tr",{id:"CopyDialogLibraryRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Library")),window.QBuilder("td",{},[window.QBuilder("div",{id:"LibrarySelectContainer"})])]),s=window.QBuilder("tr",{id:"CopyDialogDescriptionRow"},[window.QBuilder("td",{className:"left"},window.getMessage("SiteWide","Description")),window.QBuilder("td",{},[window.QBuilder("input",{name:"description",type:"text",value:i,className:"TextBox"})])]),l=window.QBuilder("div",{id:"popupError",className:"popupError"});window.$(l).setStyle({display:"none"});var d=window.QBuilder("form",{id:"copyLibraryMessageForm"},[l,window.QBuilder("input",{name:"mid",type:"hidden",value:e}),window.QBuilder("input",{name:"srclid",type:"hidden",value:window.$F("LibrarySelect")}),window.QBuilder("table",{},[window.QBuilder("tbody",{},[a,o,s])])]);new window.Q_Window({id:"LibraryMessageCopy",title:window.getMessage("LibrarySection","CopyLibraryMessage"),width:"auto",height:"auto",closeButton:!0,buttons:[{icon:"cancel",text:window.getMessage("SiteWide","Cancel"),click:"MessageLibrary.cancelMessageCopy",className:"negative"},{icon:"check",text:window.getMessage("SiteWide","Copy"),click:"MessageLibrary.saveMessageCopy",className:"positive"}]}).setContent(d),"MVD"==r&&window.$(o).hide(),new window.Ajax.Request(t.a.getAjaxURL("SetupCopyLibraryMessage",null,{LibraryID:n.a.activeLibraryId}),{parameters:{mid:e},onSuccess:function(e){var i=e.responseText.evalJSON(),t=i.Libraries,n=[],o=window.$F("LibrarySelect"),a=void 0;for(var s in t)a=s==o?window.QBuilder("option",{value:s,selected:!0},t[s]):window.QBuilder("option",{value:s},t[s]),n.push(a);var l=window.QBuilder("select",{name:"library"},n);window.$("LibrarySelectContainer").appendChild(l);var d=window.MessageLibrary.MessageCategories,c=[],u="";for(var w in d)a=window.QBuilder("option",{value:w},window.MessageLibrary.categoryMap[w]),w==r&&(u=w,a.setAttribute("selected","selected")),"MVD"!=r&&"MVD"==w||c.push(a);"MVD"==r&&(u="MVD");var p=window.QBuilder("select",{id:"LibraryMessageCategory",name:"category",value:u,className:"input"},c);window.$("CopyLibraryMessageCategoryContainer").appendChild(p)}})},cancelMessageCopy:function(){window.Q_Window.closeWindow("LibraryMessageCopy")},saveMessageCopy:function(){var e=window.$("CategorySelector").value,i=window.$("copyLibraryMessageForm").serialize(!0),r="";if(i.description||(r+=window.getMessage("LibrarySection","DescriptionNotValid")+"<br/>"),i.mid||(r+=window.getMessage("LibrarySection","MessageNotValid")+"<br/>"),i.library||(r+=window.getMessage("LibraryNotValid")+"<br/>"),i.category||(r+=window.getMessage("LibrarySection","CategoryNotValid")+"<br/>"),""==r){var o=this;new window.Ajax.Request(t.a.getAjaxURL("saveLibraryMessageCopy",null,{LibraryID:n.a.activeLibraryId}),{parameters:i,onSuccess:function(i){window.Q_Window.closeWindow("LibraryMessageCopy"),o.loadMessages(e),o.updateCategorySelector(e)}})}else window.$("popupError").show(),window.$("popupError").innerHTML=r}},window.LibraryGlobal={stopEnter:function(e){e=e||window.event,e.keyCode==a.KEY_RETURN&&e.stop()},buildLibrarySelectMenu:function(){for(var e=[],i=0;i<window.Qualtrics.Library.libraries.length;++i){var r=window.Qualtrics.Library.libraries[i];e.push({display:r.name,action:"LibraryGlobal.setActiveLibrary("+r.id+");"}),r.id==window.Qualtrics.Library.activeLibraryID&&(e[i].icon="check")}return{items:e}},setActiveLibrary:function(e){t.a.post("setActiveLibrary",e)}}},function(e,i){window.angular.module("cp.library.shared").constant("libraryElementDescriptionMaxBytes",100)},function(e,i){angular.module("cp.library.shared").service("FormFallbackUploadService",["$window","$q","FolderDataService",function(e,i,r){function t(e){return a(e,!1)}function n(e){return a(e,!0)}function o(){return void 0!==angular.element("<input>").attr("type","file")[0].files}function a(r,t){var n=s(),o=c();angular.element(r).attr("name","file-field");var a=u([r,w("T",l()),w("library",d()),w("category",encodeURI(o.name)),w("callback",n),w("isImage",t)]);a.attr("target",n);var y=p(n),v=i.defer();return e[n]=function(i){i.errorMessage?v.reject(new Error(i.errorMessage)):"Success"===i.requestStatus&&(i.folderId=o.folderId,v.resolve(i)),a.remove(),y.remove(),delete e[n]},angular.element(document.body).append(y).append(a),a.submit(),v.promise}function s(){return"_q_file_upload_"+(new Date).getTime()}function l(){return angular.element("#T").val()}function d(){return e.LibraryService.activeLibraryId}function c(){var e=r.getSelectedFolder();return e==r.getAllElementsFolder()&&(e=r.getFolder(r.uncategorizedFolderId)),e}function u(e){var i=angular.element("<form>").attr("method","POST").attr("action",window.URLTools.getAjaxURL("UploadLibraryElementViaFormPostFallback")).attr("enctype","multipart/form-data").css("display","none");return angular.forEach(e,function(e){i.append(e)}),i}function w(e,i){return angular.element("<input>").attr("type","hidden").attr("name",e).val(i)}function p(e){return angular.element("<iframe>").attr("src","about:blank").attr("id",e).attr("name",e).css("display","none")}return{uploadFileFromInput:t,uploadGraphicFromInput:n,checkAjaxUploadSupport:o}}])},function(e,i){angular.module("cp.library.shared.selector").factory("LibraryService",["$rootScope","$q","$window",function(e,i,r){function t(){return y||(y=r.LibraryService.activeLibraryId),y}function n(){return v||(b=r.LibraryService.libraryList.data,v=r.LibraryService.libraryList.libraries),v}function o(){return g||(g=r.LibraryService.currentSection),g}function a(e){var i=0;switch(o()){case"Surveys":this.hasPermissionForType(e,"Survey")&&(i+=b[e].LS.Count),this.hasPermissionForType(e,"Block")&&(i+=b[e].LB.Count),this.hasPermissionForType(e,"Question")&&(i+=b[e].LQ.Count);break;case"Graphics":i=b[e].IM.Count;break;case"Files":i=b[e].F.Count;break;case"Messages":i=b[e].MS.Count}return i}function s(){return window.jQuery("#T")[0].value}function l(e,i){switch(i||(i=y),g){case"Surveys":b[i].LS.Count+=e;break;case"Graphics":b[i].IM.Count+=e;break;case"Files":b[i].F.Count+=e;break;case"Messages":b[i].MS.Count+=e}}function d(){return y}function c(e,i){return"1"==r.LibraryService.libraryListPermissions.Permissions[e]["use"+i+"Library"]}function u(e){var i=r.LibraryService.permissions,t=[e];"Surveys"==e&&(t=["Survey","Block","Question"]);for(var n=0;n<t.length;++n){var o=t[n];if("1"==i[f[o]])return!0}return!1}function w(){return m}function p(){m=!0}var y=void 0,v=void 0,g=void 0,b=void 0,m=!1,f={Block:"manageBlockLibrary",Survey:"manageSurveyLibrary",Question:"manageQuestionLibrary",Files:"manageLibraryFiles",Graphics:"manageLibraryGraphics",Messages:"manageMessages"};return{getActiveLibraryId:t,getLibraryList:n,getLibraryCountForCurrentSection:a,getToken:s,changeLibraryElementCount:l,isRedirecting:w,beginRedirecting:p,hasPermissionToCopy:u,hasPermissionForType:c,getStoredActiveLibrary:d,__test_only__:{getStoredLibraryMap:function(){return v}}}}])},function(e,i){angular.module("DateFilterModule",[]).filter("dateFilter",["$filter",function(e){"use strict";var i=(new Date).getTime();return function(r,t){if(!r)return"";var n=void 0;return n="number"==typeof r?1e3*r:new Date(r).getTime(),n>10*i&&(n/=1e3),e("date")(n,t||"medium")}}])},function(e,i){angular.module("cp.library.shared.fileSizeFilterModule",[]).filter("fileSizeFilter",["$filter","qtranslateFilter",function(e,i){return function(e){var r=e.size;return r=parseInt(r,10),0===r&&"URL"==e.type?"":r<999?r+" "+i("LibrarySection.FileSizeBytes"):r<1e6?Math.floor(r/1e3)+" KB":r>=1e6?(r/1e6).toFixed(1)+" MB":""}}])},function(e,i,r){"use strict";function t(e,i){for(var r=e;n(r)>i;)r=r.slice(0,-1);return r}function n(e){return e&&e.length?new Blob([e]).size:0}window.angular.module("cp.library.shared").filter("stringBytes",function(){return t})},function(e,i){angular.module("cp.library.shared").controller("CopyModalController",["$scope","$window","$rootScope","LibraryService","libraryFolderConversionService","FolderDataService","qtranslateFilter",function(e,i,r,t,n,o,a){function s(){var r=i.LibraryService.libraryListPermissions.Permissions;for(var n in r)r.hasOwnProperty(n)&&l(r,n)&&(e.libsWithPermissions[n]=i.LibraryService.libraryList.libraries[n],n==t.getActiveLibraryId()&&(e.selectedLibrary={id:n,name:i.LibraryService.libraryList.libraries[n]}));e.selectedLibrary.id||(e.selectedLibrary.name=a("EditSection.SelectLibrary"))}function l(i,r){switch(e.copyFileType){case"File":return"1"==i[r].manageLibraryFiles;case"Graphic":return"1"==i[r].manageLibraryGraphics;case"Block":return"1"==i[r].manageBlockLibrary;case"Survey":return"1"==i[r].manageSurveyLibrary;case"Question":return"1"==i[r].manageQuestionLibrary;case"Message":return"1"==i[r].manageMessages}}e.titleMessage=e.copyFileType+"s.Copy"+e.copyFileType,e.libsWithPermissions={},e.newFileName=e.sourceFile.name,e.selectedLibrary={},e.$on("foldersSet",function(){e.busy=!1}),function(){s(),e.getIconType&&(e.iconType=e.getIconType(e.sourceFile.type)),e.folderData=o.getFolderData().fldData,e.currentFolderId=o.getSelectedFolder().folderId,e.currentFolderId===o.allElementsFolderId&&(e.currentFolderId=o.uncategorizedFolderId),e.destinationFolder=e.currentFolderId}(),e.destinationFolderSelected=function(i,r){e.destinationFolderName=i,e.destinationFolder=r},e.librarySelected=function(i,r,t){e.selectedLibrary.name=r.label,e.selectedLibrary.id=r.value,n.getForeignLibraryFolderData(r.value).then(function(i){e.folderData=i}),e.busy=!0},e.confirmCopy=function(){e.selectedLibrary.id&&(e.copyFn(e.sourceFile,e.newFileName,e.destinationFolder,e.destinationFolderName,e.selectedLibrary.id,t.getActiveLibraryId()),e.copyModal.hide())},e.cancelCopy=function(){e.copyModal.hide()}}])},function(e,i,r){"use strict";var t=r(4);window.angular.module("cp.library.shared.selector").controller("LibrarySelectorController",["$scope","$q","LibraryService","$timeout","$window",function(e,i,r,n,o){!function(){r.getLibraryList();var i=r.getActiveLibraryId();e.libraryTypeList=o.LibraryService.libraryTypeList,e.libraryList=o.LibraryService.libraryList,e.activeLibraryId=i,e.activeLibraryName=e.libraryTypeList[i].name}(),e.librarySelected=function(i){if(e.hasPermission(i)){if("TranslateMessage"==o.LibraryService.currentSubSection||"EditSurvey"==o.LibraryService.currentSubSection||"EditBlock"==o.LibraryService.currentSubSection||"TranslateSurvey"==o.LibraryService.currentSubSection||"TranslateBlock"==o.LibraryService.currentSubSection){var r=o.LibraryService.currentSection;t.a.post("ChangeLibraryPageAndActiveLibrary",r,"None",i,!0)}else o.LibraryGlobal.setActiveLibrary(i)}},e.getLibraryCount=function(e){return r.getLibraryCountForCurrentSection(e)},e.flashSelection=function(i){i.addClass("Flashing"),n(function(){i.removeClass("Flashing"),n(function(){e.showingLibrarySelector=!1,r.beginRedirecting(),e.$apply()},200)},80)},e.hasPermission=function(e){switch(o.LibraryService.currentSection){case"Surveys":return"1"==o.LibraryService.libraryListPermissions.Permissions[e].useSurveyLibrary||"1"==o.LibraryService.libraryListPermissions.Permissions[e].useQuestionLibrary||"1"==o.LibraryService.libraryListPermissions.Permissions[e].useBlockLibrary;case"Graphics":return"1"==o.LibraryService.libraryListPermissions.Permissions[e].useLibraryGraphics;case"Files":return"1"==o.LibraryService.libraryListPermissions.Permissions[e].useLibraryFiles;case"Messages":return"1"==o.LibraryService.libraryListPermissions.Permissions[e].useMessages}}}])},function(e,i){angular.module("cp.library.shared").controller("ValidationTableController",["$scope","$window","qhttp",function(e,i,r){function t(e){var i={params:{mid:e}};return r.submit("GetMessagePreview",i)}function n(){o.Errors&&void 0===o.Errors.length||(o.Errors={}),o.Custom&&void 0===o.Custom.length||(o.Custom={}),e.validationErrors=[];for(var i in o.Errors){var r={};r.code=i,r.name=o.Custom[i],r.message=o.Errors[i],r.name||(a[i]&&a[i].Attributes?r.name=a[i].Attributes.hint||"":r.name=""),e.isCustomError(i)&&(d=Math.max(d,parseInt(i.substr(21))+1),e.validationErrors[i]={Attributes:{hint:o.Custom[i]},VALUE:o.Errors[i]}),e.validationErrors.push(r)}var t=e.validationErrors[e.validationErrors.length-1]||{};e.selectError(t)}var o=void 0,a=void 0,s=void 0,l=void 0,d=void 0,c=/%\d/;e.isCustomError=function(e){if(!e)return!1;var i=parseInt(e.substring(21,22));return"CUSTOM_VALIDATION"==e.substring(3,20)&&!isNaN(i)},e.selectError=function(i){l=i,c.test(i.message)?e.containsVariable=!0:e.containsVariable=!1},e.errorIsSelected=function(e){return l===e},e.startEditingCustomErrorName=function(i){e.isCustomError(i.code)&&(i.editing=!0,i.originalName=i.name)},e.stopEditingCustomErrorName=function(e){e.name!==e.originalName&&(0===e.name.trim().length&&(e.name=e.originalName),o.Custom[e.code]=e.name),e.editing=!1,delete e.originalName},e.saveErrorMessage=function(e){e.message.trim().length>0?o.Errors[e.code]=e.message:e.message=o.Errors[e.code]},e.createNewValidationError=function(i){if(e.defaultLanguage){var r={};i&&(r.code="VE_CUSTOM_VALIDATION_"+d,r.message="",r.name="",e.startEditingCustomErrorName(r),d++),e.validationErrors.push(r),e.selectError(r)}},e.getValidationErrors=function(){s=[];for(var e in a)if(!o.Errors[e]){var i={};i.label=a[e].Attributes.hint||"",i.value=e,i.value&&s.push(i)}return s.sort(function(e,i){return e.label.localeCompare(i.label)})},e.changeValidationErrorType=function(i,r,t){var n=r;delete o.Errors[i.code],i.code=n,i.name=t.label,i.message=a[n].VALUE,o.Errors[n]=i.message,e.selectError(i)},e.deleteError=function(i){var r=e.validationErrors.indexOf(i);e.validationErrors.splice(r,1),delete o.Errors[i.code],delete o.Custom[i.code]},function(){e.containsVariable=!1,e.validationErrors=[],d=0,o=e.messageContent,e.$watch("messageContent",function(e){e&&e.Errors&&a&&(o=e,n())}),r.submit("GetValidationErrors",{}).then(function(r){a=r,e.putErrorsOnWindow&&(i.ValidationMessages={validationErrorDescriptions:a}),e.editing?e.messageContent&&e.messageContent.Errors||!e.messageId?n():t(e.messageId).then(function(i){i.Errors&&(e.messageContent?angular.copy(i,o):e.messageContent=o=i),n()}):(e.messageContent.Errors={},e.messageContent.Custom={})})}()}])},function(e,i,r){"use strict";var t=r(44),n=r.n(t);window.angular.module("cp.library.shared.selector").directive("librarySelectElement",["qtranslateFilter","cpuiVersion",function(e,i){return{restrict:"A",link:function(i,r,t){i.type||(i.type="User"),i.typeText=e("LibrarySection.LibraryType"+i.type)},templateUrl:n.a}}])},function(e,i){var r="/ui/library/shared/html/templates/librarySelectElement.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,' <span class="library-name">{{name}}</span>\n <span class="library-type">{{typeText}}</span>\n <count-bubble count="count"></count-bubble>')}]),e.exports=r},function(e,i,r){"use strict";var t=r(46),n=r.n(t);window.angular.module("cp.library.shared.selector").directive("librarySelector",["$compile","cpuiVersion",function(e,i){return{restrict:"AE",link:function(i,r,t){function n(e){return function(){i.librarySelected(e)}}t.inModal?i.inModal=!0:t.inHeader&&(i.inHeader=!0),i.getMenuDefItems=function(){var r=[];for(var t in i.libraryTypeList){var o=i.libraryTypeList[t];if(i.hasPermission(t)){var a=n(t),s=i.getLibraryCount(t),l=i.$new();l.name=o.name,l.type=o.type,l.count=s;var d=e('<div library-select-element class="library-select-element"></div>')(l);r.push({label:d,action:a,value:t,selected:t===i.activeLibraryId})}}return r}},controller:"LibrarySelectorController",templateUrl:n.a}}])},function(e,i){var r="/ui/library/shared/html/templates/librarySelector.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="library-selector" ng-class="{\'btn btn-hover btn-inverted btn-select\':inHeader, active: menuIsOpen, \'btn btn-select\':inModal}" qstrap.select-menu items="getMenuDefItems()" ng-model="selectedLibraryId" options="{className: \'library-selector-menu\'}">\n  <span>{{activeLibraryName}}</span>\n  <span class="caret"></span>\n</div>\n')}]),e.exports=r},function(e,i){angular.module("cp.library.shared.selector").directive("ngPlaceholder",function(){return{restrict:"A",link:function(e,i,r){var t=r.ngPlaceholder;e.$watch(function(){return e.$eval(t)},function(){i[0].placeholder=e.$eval(t)})}}})},function(e,i){angular.module("cp.library.shared").directive("editModal",["$document","$window",function(e,i){return{restrict:"A",require:["^resizableModal"],controller:["$scope","$element","$attrs",function(e,i,r){i.children()[1];e.previewMode=!0,r.preview&&"false"===r.preview&&(e.previewMode=!1),e.togglePreview=function(){e.previewMode=!e.previewMode,console.log("Preview:",e.previewMode)}}],link:function(e,r,t,n){function o(e,i){if(d.isShowing()){var r=0,t=0;l.each(function(){r=Math.max(r,this.scrollWidth+this.offsetLeft),t=Math.max(t,this.scrollHeight+this.offsetTop)});var n=r+s.outerWidth()-s.width(),o=t+s.outerHeight()-s.height();d.resize(n,o,"min"),s.css("height",d.getMaxHeightForChild(s))}}var a=angular.element(i),s=window.jQuery(r),l=r.children(),d=n[0];r.css("overflow","auto"),a.on("resize",o),s.on("resize",o)}}}])},function(e,i){angular.module("cp.library.shared").directive("uploadDropArea",["$document",function(e){"use strict";return{restrict:"A",scope:{dropMessage:"&",fileDropAction:"&",dropComplete:"&?",suppressDrop:"&?"},link:function(i,r,t){function n(e,i,r){return i<=e&&e<=r}function o(e,i){return n(e.pageX,i.left,i.right)}function a(e,i){return n(e.pageY,i.top,i.bottom)}function s(){m.css("opacity",1),b.hide()}function l(){b.show(),m.css("opacity",.2)}function d(){var e=y.offset();return e.right=e.left+y.outerWidth(),e.bottom=e.top+y.outerHeight(),e}function c(e){var i=d(),r=o(e.originalEvent,i),t=a(e.originalEvent,i);r&&t||s()}function u(e){if(i.suppressDrop&&!i.suppressDrop()){v!==i.dropMessage()&&(v=i.dropMessage(),g.text(v));var r=d(),t=o(e.originalEvent,r),n=a(e.originalEvent,r);t&&n?l():s()}e.preventDefault()}function w(e){var r=d(),t=o(e.originalEvent,r),n=a(e.originalEvent,r);if(t&&n){var l=e.originalEvent.dataTransfer.files;l?i.suppressDrop&&!i.suppressDrop()&&p(l):console.log(window.getMessage("LibrarySection","NoDragDropSupport"))}s(),e.preventDefault()}function p(e){for(var r=0;r<e.length;r++){var t=e[r],n=i.fileDropAction({file:t});i.dropComplete&&(i.dropComplete(),n&&n.finally&&n.finally(i.dropComplete))}}var y=r,v=i.dropMessage(),g=angular.element('<span class="upload-message">'+v+"</span>"),b=window.jQuery('<div class="upload overlay"><span class="icon icon-upload-filled-lg"></span></div>');b.append(g),y.append(b);var m=y.children().not(".upload.overlay");s(),t.registerWindow&&"true"===t.registerWindow?(e.on("dragenter",u),e.on("dragover",u),e.on("dragleave",c),e.on("mouseout",c),e.on("drop",w)):(y.on("dragenter",u),y.on("dragover",u),y.on("dragleave",c),y.on("mouseout",c),y.on("drop",w))}}}])},function(e,i,r){"use strict";var t=r(51),n=r.n(t);window.angular.module("cp.library.shared").directive("validationContentEditor",["$filter","cpuiVersion",function(e,i){return{restrict:"A",scope:{editing:"=",messageContent:"=",messageIdFn:"&?messageId",defaultLanguage:"<"},link:function(i,r,t){i.errorNamePlaceholder=e("qtranslate")("LibrarySection.EnterValidationErrorName")+"...",i.errorMessagePlaceholder=e("qtranslate")("LibrarySection.EnterCustomValidationErrorMessage")+"...",i.selectErrorName=e("qtranslate")("LibrarySection.SelectValidation"),i.messageId=i.messageIdFn(),t.hasOwnProperty("errorsOnWindow")&&(i.putErrorsOnWindow=!0)},controller:"ValidationTableController",templateUrl:n.a}}])},function(e,i){var r="/ui/library/shared/html/templates/validationErrorTable.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="validation-content-editor" >\n  <table class="simple-table">\n    <thead>\n      <th qtranslate>SiteWide.Error</th>\n      <th qtranslate>SiteWide.Message</th>\n      <th></th>\n    </thead>\n    <tr ng-repeat="error in validationErrors" ng-click="selectError(error)" ng-class="{\'selected-table-row\': errorIsSelected(error), \'last\': $last}">\n      <td class="name-column">\n        <div class="error-name-edit" ng-if="errorIsSelected(error)" ng-switch="isCustomError(error.code) && error.editing">\n          <div ng-switch-default>\n            <div ng-class="{active: menuIsOpen, custom: isCustomError(error.code)}" class="btn btn-select" qstrap.menu select-menu="true" items="getValidationErrors()" action="changeValidationErrorType(error, $value, $item, $evt)">\n              <div class="caret"></div>\n              {{error.name || selectErrorName}}\n            </div>\n            <span class="validation-error-option" ng-show="isCustomError(error.code)" ng-click="startEditingCustomErrorName(error)" qtranslate>SiteWide.Rename</span>\n          </div>\n          <div ng-switch-when="true">\n            <input type="text" class="input-text" ng-model="error.name" ng-enter-esc="stopEditingCustomErrorName(error)" placeholder="{{errorNamePlaceholder}}">\n          </div>\n        </div>\n        <span ng-if="!errorIsSelected(error)" class="error name">\n          {{error.name || selectErrorName}}\n        </span>\n      </td>\n      <td class="message-column">\n        <div ng-if="errorIsSelected(error) && error.code" class="error-message-edit">\n          <input type="text" class="input-text" ng-model="error.message" ng-enter-esc="saveErrorMessage(error)" placeholder="{{errorMessagePlaceholder}}">\n        </div>\n        <div ng-if="!errorIsSelected(error)" class="error message">\n        {{error.message || \'\'}}\n        </div>\n      </td>\n      <td class="actions-column" ng-click="deleteError(error)">\n        <span class="icon icon-x-sm warning"></span>\n        <div class="error delete" qtranslate>SiteWide.Delete</div>\n      </td>\n    </tr>\n  </table>\n  <div class="btn btn-primary" ng-click="createNewValidationError()" ng-disabled="!defaultLanguage" qtranslate>LibrarySection.AddValidation</div>\n  <div class="btn btn-primary" ng-click="createNewValidationError(true)" ng-disabled="!defaultLanguage" qtranslate>LibrarySection.CreateCustomValidation</div>\n  <div class="warning message">\n    <span ng-show="containsVariable">{{\'LibrarySection.VariableWarning\' | qtranslate:\'%1\'}}</span>\n  </div>\n</div>')}]),e.exports=r},,,,function(e,i){!function(){"use strict";angular.module("cp.filter",["cp"]),window.jQuery.noConflict()}()},function(e,i){angular.module("cp.filter").controller("SearchController",["$scope","SearchService",function(e,i){e.updateSearchTerm=function(e){i.setSearchTerm(e)},e.hasActiveSearch=function(e){return!!e}}])},function(e,i,r){"use strict";var t=r(58),n=r.n(t);window.angular.module("cp.filter").directive("paginationFooter",["$window","cpuiVersion",function(e,i){return{restrict:"AE",replace:!0,link:function(i,r,t){i.smallCutoff=2,i.largeCutoff=15,i.nextMessage=e.getMessage("SiteWide","PaginateNext"),i.previousMessage=e.getMessage("SiteWide","PaginatePrevious"),i.pageMessage=e.getMessage("SiteWide","Page"),i.outOfMessage=e.getMessage("SiteWide","OutOf"),i.jumpMessage=e.getMessage("SiteWide","Jump")},templateUrl:n.a}}])},function(e,i){var r="/ui/shared/filter/html/templates/paginationFooter.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="pagination-footer" ng-cloak ng-if="totalPages && totalPages > 1 && filteredElements.length">\n  <div class="pagination">\n    <div class="navigation-button">\n      <div class="Button Previous" ng-click="previousPage(currentPageIndex, searchFilter, totalPages)" ng-show="currentPageIndex > 1">{{previousMessage}}</div>\n    </div>\n    <div class="jump-index" ng-show="totalPages <= smallCutoff">&nbsp;</div>\n    <div class="jump-index" ng-show="totalPages > smallCutoff && totalPages <= largeCutoff">\n      &nbsp;\n      <span class="jump-link" ng-repeat="pageIndex in getPages(totalPages)" ng-class="{SelectedPage: currentPageIndex == pageIndex}" ng-click="jumpToPage(pageIndex, searchFilter, totalPages)" >{{pageIndex}}</span>\n      &nbsp;\n    </div>\n    <div class="jump-index jump-button" ng-show="totalPages > largeCutoff">\n      {{pageMessage}} {{currentPageIndex}} {{outOfMessage}} {{totalPages}}\n      <span class="jump-menu" id="PaginationMenuButton" ng-click="showPageJumpMenu($event)" ng-show="totalPages > largeCutoff">\n        {{jumpMessage}}\n        <div class="icon icon-angle-down-sm"></div>\n      </span>\n    </div>\n    <div class="navigation-button">\n      <div class="Button Next" ng-click="nextPage(currentPageIndex, searchFilter, totalPages)" ng-show="currentPageIndex < totalPages">{{nextMessage}}</div>\n    </div>\n  </div>\n</div>\n')}]),e.exports=r},function(e,i){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};angular.module("cp.filter").service("categorizationService",[function(){this.sortIntoCategories=function(e,i,t,n){function o(e,i){s[e]&&s[e].push(i)}n&&n(e);var a=[],s={};if(i)for(var l=0;l<i.length;l++){var d=i[l];s[d]=[]}for(var c=0;c<e.length;c++){var u=e[c],w=t(u);if("object"!==(void 0===w?"undefined":r(w)))o(w,u);else if(w.length>0)for(var p=0;p<w.length;p++){var y=w[p];o(y,u)}}for(var v=0;v<i.length;v++){var g=i[v],b={key:g,content:s[g]};b.content.length>0&&a.push(b)}return a}}])},function(e,i){angular.module("cp.filter").service("FilterService",["PaginationService","SearchService","FolderDataService","FolderScrollService","SortService","$window","$rootScope","sumo",function(e,i,r,t,n,o,a,s){function l(){a.$watch(i.getSearchTerm,function(i,r){r!==i&&(e.resetCurrentPageIndex(),v.updateFilter())}),a.$watch(r.getSelectedFolder,function(i,r){r.folderId!==i.folderId&&(e.resetCurrentPageIndex(),v.updateFilter())}),a.$watch(e.getCurrentPage,function(e,i){i!==e&&v.updateFilter()}),a.$watch(n.getCurrentSortMethod,function(i,r){r!==i&&(e.resetCurrentPageIndex(),v.updateFilter())})}function d(){g={}}function c(e,i){e&&(g[e]||(g[e]={}),g[e][i]||(g[e][i]=0),g[e][i]++)}var u={},w=void 0,p=void 0,y=[],v=this,g={},b="All";!function(){l()}(),this.initializeElements=function(e){y=e},this.filter=function(t){var o=Date.now();d(),t&&v.revealElementInContainingFolder(t),this.setFolder(r.getSelectedFolder().folderId);for(var a=[],l=0;l<y.length;l++){var p=y[l],g=!0;for(var m in u)if(u.hasOwnProperty(m)&&!u[m](p[m],p)){g=!1;break}p.name=p.name||"";var f=p.name.toLowerCase().indexOf(i.getSearchTerm().toLowerCase())>-1,S=p.id==i.getSearchTerm();(f||S)&&(c(p.type,p.folderId),g&&a.push(p))}if(!a.length&&v.getFilter("type"))return v.removeFilter("type"),b="All",v.filter();e.calculatePages(a.length),a=n.sortElements(a),w&&w(a),a=e.filterOnPaginatedPage(a);var h=Date.now();return s.logTiming(s.timingTypes.computationTime,"filter",h-o),a},this.setFilterCriteria=function(e){u=e},this.setFolder=function(e){e&&e!==r.getAllElementsFolder().folderId?e===r.sharedSurveyFolderId?this.setFilterFunction("folderId",function(e,i){return i.ownerId!==o.Qualtrics.User.userId}):this.setFilter("folderId",e):delete u.folderId},this.setFilter=function(e,i){var r=function(e){return e==i};this.setFilterFunction(e,r)},this.setFilterFunction=function(e,i){u[e]=i},this.removeFilter=function(e){delete u[e]},this.getFilter=function(e){return u[e]},this.revealElementInContainingFolder=function(i,t){var n=t||i.folderId;r.setSelectedFolder(n),w=function(r){e.updatePageIndexToRevealElement(r,i),w=void 0}},this.setUpdateFilterFunction=function(e){p=e},this.updateFilter=function(){p&&p(v.filter())},this.setCurrentToggleFilter=function(e){b=e},this.getCurrentToggleFilter=function(){return b},this.getCountForType=function(e,i){if(!g[e])return 0;var t=0;if(i&&i!=r.getAllElementsFolder().folderId)t=g[e][i]||0;else for(var n in g[e])t+=g[e][n];return t}}])},function(e,i){angular.module("cp.filter").service("PaginationService",["$window","FolderDataService","$timeout","FolderScrollService","$rootScope","SearchService",function(e,i,r,t,n,o){function a(e,i){var r=s(e,i);return r>-1?Math.floor(r/l)+1:1}function s(e,i){for(var r=0;r<e.length;r++)if(e[r].id==i.id)return r;return-1}var l=20,d=1,c=1;n.$watch(o.getSearchTerm,function(){d=1}),n.$watch(i.getSelectedFolder,function(){d=1}),this.filterOnPaginatedPage=function(e){this.calculatePages(e.length);var i=(d-1)*l;return e=e.slice(i,i+l)},this.nextPage=function(){return d<c&&d++,d},this.previousPage=function(){return d>1&&d--,d},this.resetCurrentPageIndex=function(){return d=1},this.getPages=function(e){for(var i=[],r=1;r<=e;++r)i.push(r);return i},this.getCurrentPage=function(){return d},this.calculatePages=function(e){return c=Math.ceil(e/l),d>c&&this.previousPage(),c},this.getTotalPages=function(){return c},this.jumpToPage=function(e){return e=parseInt(e),e<1&&(e=1),e>c&&(e=c),d=e},this.showPageJumpMenu=function(i){e.Qualtrics.Menu.showMenu(this.buildPageJumpMenu.bind(),e.$("PaginationMenuButton"),{},i)},this.buildPageJumpMenu=function(){for(var e=[],i=1;i<=c;++i){var r=i===d?"check":"";e.push({action:"SurveyLibraryRefresh.jumpToPage("+i+")",display:i,className:r})}return{items:e}},e.SurveyLibraryRefresh||(e.SurveyLibraryRefresh={}),e.SurveyLibraryRefresh.jumpToPage=function(){var i=arguments,r=angular.element(e.$("PaginationMenuButton")).scope();r.$apply(function(){r.jumpToPage.apply(r,i)})},this.updatePageIndexToRevealElement=function(e,i){d=a(e,i)},this.getElementsPerPage=function(){return l},this.setElementsPerPage=function(e){l=e}}])},function(e,i){angular.module("cp.filter").factory("SearchService",[function(){function e(e){r=e}function i(){return r}var r="";return{setSearchTerm:e,getSearchTerm:i}}])},function(e,i){angular.module("cp.filter").factory("SortService",["sumo",function(e){function i(e){for(var i=0;i<e.length;i++)if(e[i].name)if(e[i].asc_desc){var r={name:e[i].sort,asc:!0},t={name:e[i].sort,asc:!1};h.push(r),h.push(t)}else{var n={name:e[i].sort,asc:void 0};h.push(n)}}function r(i){var r=Date.now(),c=C.getCurrentSortMethod().name,y=void 0;switch(c){case"Description":case"SurveyName":y=i.sort(t);break;case"Type":y=i.sort(s);break;case"Date":y=i.sort(o);break;case"LastModified":y=i.sort(u);break;case"CreationDate":y=i.sort(w);break;case"Size":y=i.sort(a);break;case"Star":y=i.sort(p);break;case"SurveyStatus":y=i.sort(d);break;case"responses":y=i.sort(l);break;case"Owner":y=i.sort(n);break;default:y=i}C.isSortAscending()||(y=y.reverse());var v=Date.now();return e.logTiming(e.timingTypes.computationTime,"sort",v-r,{sortType:c}),y}function t(e,i){var r=e.name.localeCompare(i.name);return 0===r&&(r=C.isSortAscending()?o(e,i):o(i,e)),r}function n(e,i){var r=e.ownerLastName.localeCompare(i.ownerLastName);return 0===r&&0===(r=e.ownerFirstName.localeCompare(i.ownerFirstName))&&(r=C.isSortAscending()?t(e,i):t(i,e)),r}function o(e,i){var r=new Date(parseInt(e.lastModified)||0),t=new Date(parseInt(i.lastModified)||0);return r.getTime()-t.getTime()}function a(e,i){var r=e.size-i.size;return 0===r&&(r=C.isSortAscending()?t(e,i):t(i,e)),r}function s(e,i){var r=e.type.localeCompare(i.type);return 0===r&&(r=C.isSortAscending()?t(e,i):t(i,e)),r}function l(e,i){var r=e.responses,t=i.responses;"New"===e.status&&(r=0),"New"===i.status&&(t=0);var n=(t||0)-(r||0);return 0===n&&(n=C.isSortAscending()?d(e,i,!0):d(i,e,!0)),n}function d(e,i,r){var n=c(e.status)-c(i.status);return 0===n&&(n=C.isSortAscending()||r?t(e,i):t(i,e)),n}function c(e){var i=0;switch(e){case"Active":i=1;break;case"Inactive":i=3;break;case"New":i=2}return i}function u(e,i){var r=new Date(e.lastModifiedDate);return new Date(i.lastModifiedDate).getTime()-r.getTime()}function w(e,i){var r=new Date(e.creationDate);return new Date(i.creationDate).getTime()-r.getTime()}function p(e,i){var r=i.star-e.star;return 0===r&&(r=C.isSortAscending()?t(e,i):t(i,e)),r}function y(e){var i=!1;return"string"==typeof e&&(e={name:e,asc:!0},i=!0),i&&e.name==C.getCurrentSortMethod().name&&(e.asc=!C.isSortAscending()),S=e,e}function v(){return S}function g(){return S.asc}function b(){return h}function m(){for(var e=[],i=0;i<h.length;i++){var r=h[i],t=void 0;t=!0===r.asc?window.getMessage("SiteWide",r.name+"Ascending"):!1===r.asc?window.getMessage("SiteWide",r.name+"Descending"):window.getMessage("SiteWide",r.name),e.push(t)}return e}function f(e){for(var i=0;i<h.length;i++){var r=h[i],t=r.name==e.name,n=r.asc==e.asc||void 0===r.asc;if(t&&n)return i}return-1}var S={name:"Description",asc:!0},h=[],C={sortElements:r,setCurrentSortMethod:y,getCurrentSortMethod:v,isSortAscending:g,createSortMethods:i,getSortMethods:b,prepareSortOptionsForMenu:m,findIndexInSortMethods:f};return C}])},function(e,i){!function(){"use strict";angular.module("cp.library.folderConversionModule",[])}()},function(e,i){function r(e,i,r){return i in e?Object.defineProperty(e,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[i]=r,e}angular.module("cp.library.folderConversionModule").provider("libraryFolderConversionService",function(){function e(e,i,t){function n(){if(!C){l(e.LibraryService.categories);var i=a(e.LibraryService.folders),r=angular.copy(i.Elements);s(i,e.LibraryService.categories||{}),C=i,angular.equals(i.Elements,r)||v()}return C}function o(e,r){return i.submit("GetFoldersForLibrary",{url:"Ajax.php",params:{libraryId:e,librarySection:r}}).then(function(e){var i=a(JSON.parse(e.folders));return e.categories&&s(i,JSON.parse(e.categories)),i})}function a(e){return e=m(e)?{}:angular.copy(e),e.Folders=e.Folders||{},e.FolderHierarchy=e.FolderHierarchy||r({},L,[]),e.Elements=e.Elements||{},e.Folders[Q]||(e.Folders[Q]=h(),e.FolderHierarchy[L].push(Q)),e}function s(e,i){function r(e){var i=0;if(e.Folders){var r=Object.keys(e.Folders);0!==r.length&&(i=Math.max(i,Math.max.apply(null,r)))}return""+(i+1)}if(!m(i)){for(var t in i){var n=i[t].toString(),o=function(e){return""===e||e===S()}(n)?Q:function(e,i){for(var r in e)if(e.hasOwnProperty(r)&&e[r]===i)return r}(e.Folders,n);o?e.Elements[t]&&e.Folders[e.Elements[t]]===n||(e.Elements[t]=o):function(e,i,t){var n=r(e);e.Folders[n]=i,e.FolderHierarchy[L].push(n),e.Elements[t]=n}(e,n,t)}for(var a in e.Elements)i.hasOwnProperty(a)||delete e.Elements[a]}}function l(e){if(!m(e)){var i={};for(var r in e)e.hasOwnProperty(r)&&e[r]===S()&&(i[r]=h());g(i)}}function d(e){e.processFolderData(n()),e.setFolderUpdateHandler(function(i){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];var o=e.createFolderElementFromConstructedFolders();switch(t||(t=[]),i){case e.actions.createFolder:c(o);break;case e.actions.moveFolderUnderParent:u(o);break;case e.actions.deleteFolder:w(o,t[0]);break;case e.actions.renameFolder:p(o,t[0],t[1]);break;case e.actions.moveElementToFolder:y(o,t[0],t[1])}})}function c(e){return C=a(e),v()}function u(e){return C=a(e),v()}function w(e,i){function r(e,i){return e[i]=h(),e}return g(b(C,i).reduce(r,{})),C=a(e),v()}function p(e,i,r){function t(e,i){return e[i]=r,e}return g(b(C,i).reduce(t,{})),C=a(e),v()}function y(e,i,t){return g(r({},i,C.Folders[t])),C=a(e),v()}function v(){var r=window.jQuery.param({T:f(),Folders:C,LibraryID:e.LibraryService.activeLibraryId,Section:e.LibraryService.currentSection});return i.submit("SetLibraryFolders",{url:"Ajax.php",method:"POST",headers:{"Content-Type":t},data:r})}function g(e){if(!m(e)){var r=window.jQuery.param({T:f(),elements:e});return i.submit("UpdateLibraryCategories",{url:"Ajax.php",method:"POST",headers:{"Content-Type":t},data:r})}}function b(e,i){var r=[];for(var t in e.Elements)e.Elements.hasOwnProperty(t)&&e.Elements[t]===i&&r.push(t);return r}function m(e){return!e||0===Object.keys(e).length}function f(){return e.document.getElementById("T").value}function S(){return e.getMessage("LibrarySection","Unassigned")}function h(){return e.getMessage("Folders","Uncategorized")}var C=void 0,L="ROOT",Q="-1";return{getFolderData:n,getForeignLibraryFolderData:o,decorateFolderDataService:d}}this.$get=["$window","qhttp","formContentType",e]})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,i,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=(r(17),r(163)),n=(r.n(t),r(164)),o=(r.n(n),r(165)),a=(r.n(o),r(166));r.n(a)},function(e,i){},function(e,i){},function(e,i){},function(e,i){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,i,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});r(335),r(230),r(162)},function(e,i,r){"use strict";var t=(r(28),r(31),r(30),r(231)),n=(r.n(t),r(232),r(233),r(234),r(235),r(236),r(242),r(243),r(245),r(246),r(247),r(248),r(249),r(251),r(253),r(255),r(257),r(259),r(260)),o=(r.n(n),r(261));r.n(o),r(262)},function(e,i){angular.module("cp.surveys.edit",["cp","qstrap","mgcrea.ngStrap.modal","cp.library.folderConversionModule","cp.library.shared","cp.folderdata","cp.xmproject","surveys.edit.referenceLists","cp.surveyapprovals"]),window.jQuery.noConflict()},function(e,i,r){"use strict";var t=r(2);r.n(t);t.module("cp.surveys.edit").controller("CopyBlockToLibraryController",["$scope","$window","qhttp","libraryFolderConversionService",function(e,i,r,t){function n(){e.librarySelectorBusy=!0,r.submit("getLibraries",{params:{Type:"BlockCopyToLibraries"}},{userBlocking:!0,blocksNav:!1}).then(function(i){e.librarySelectorBusy=!1,e.libsWithPermissions=i;for(var r=Object.keys(i),n=void 0,o=0;o<r.length;o++)if(0===r[o].indexOf("UR_")){n=r[o];break}e.selectedLibrary.name=i[n],e.selectedLibrary.id=n,t.getForeignLibraryFolderData(n,"Surveys").then(function(i){e.folderData=i}),e.folderSelectorBusy=!0})}e.libsWithPermissions={},e.newBlockName=e.sourceBlock.name,e.selectedLibrary={name:window.getMessage("SurveyCreateWizard","LB_Library")},e.$on("foldersSet",function(){e.folderSelectorBusy=!1}),function(){e.folderData={},n()}(),e.destinationFolderSelected=function(i,r){e.destinationFolderName=i,e.destinationFolderId=r},e.librarySelected=function(i,r,n){e.selectedLibrary.name=r.label,e.selectedLibrary.id=r.value,t.getForeignLibraryFolderData(r.value,"Surveys").then(function(i){e.folderData=i}),e.folderSelectorBusy=!0},e.confirmCopy=function(){var i={url:"Ajax.php",params:{LibraryID:e.selectedLibrary.id,BlockName:e.newBlockName,Category:e.destinationFolderName,FolderId:e.destinationFolderId,BlockID:e.sourceBlock.id,SurveyID:window.Qualtrics.User.currentSurveyId}};r.submit("CopySurveyBlockToLibrary",i,{userInitiated:!0,blocksNav:!0}).then(function(){e.copyModal.hide()})},e.cancelCopy=function(){e.copyModal.hide()}}])},function(e,i,r){"use strict";var t=r(2);r.n(t);t.module("cp.surveys.edit").controller("CopyQuestionsToLibraryController",["$scope","$window","qhttp","libraryFolderConversionService",function(e,i,r,t){function n(){var e=0;e=document.documentElement.clientHeight,window.jQuery(".copy-question-modal").find(".form").css("max-height",e-300)}function o(){e.librarySelectorBusy=!0,r.submit("getLibraries",{params:{Type:"QuestionCopyToLibraries"}},{userBlocking:!0,blocksNav:!1}).then(function(i){e.librarySelectorBusy=!1,e.libsWithPermissions=i;for(var r=Object.keys(i),n=void 0,o=0;o<r.length;o++)if(0===r[o].indexOf("UR_")){n=r[o];break}e.selectedLibrary.name=i[n],e.selectedLibrary.id=n,t.getForeignLibraryFolderData(n,"Surveys").then(function(i){e.folderData=i}),e.folderSelectorBusy=!0})}function a(){r.submit("getBlockQuestionsList",{params:{sid:s,bid:e.sourceBlock.id}},{userBlocking:!0,blocksNav:!1}).then(function(i){e.questions=[];for(var r in i){var t=i[r],o=void 0,a=!1;t.Description?(a=t.HasReferenceList,o=t.Description):o=t,e.questions.push({qid:r,text:o,newText:o,shouldCopy:!a,hasReferenceList:a})}n()})}e.libsWithPermissions={},e.selectedLibrary={name:window.getMessage("SurveyCreateWizard","LB_Library")},e.$on("foldersSet",function(){e.folderSelectorBusy=!1});var s=void 0;!function(){e.folderData={},s=i.Survey.getInstance().id,o(),a()}(),e.destinationFolderSelected=function(i,r){e.destinationFolderName=i,e.destinationFolderId=r},e.librarySelected=function(i,r,n){e.selectedLibrary.name=r.label,e.selectedLibrary.id=r.value,t.getForeignLibraryFolderData(r.value,"Surveys").then(function(i){e.folderData=i}),e.folderSelectorBusy=!0},e.confirmCopy=function(){for(var i=0;i<e.questions.length;i++){var t=e.questions[i];if(t.shouldCopy){var n={params:{lid:e.selectedLibrary.id,category:e.destinationFolderName,sourcesurvey:s,copy:t.qid,description:t.newText,folderId:e.destinationFolderId}};r.submit("saveLibraryQuestionCopyTo",n,{userBlocking:!0,userInitiated:!0,blocksNav:!0}).then(e.cancelCopy)}}},e.cancelCopy=function(){e.copyModal.hide()}}])},function(e,i,r){"use strict";var t=r(2);r.n(t);t.module("cp.surveys.edit").controller("CreateNewValidationController",["$scope","$window","qhttp","libraryFolderConversionService","formContentType","sumo",function(e,i,r,t,n,o){function a(){var i=e.messageDescription.trim(),r=0!==i.length,t=e.messageContent;return r=r&&!(!t.Errors||!t.Custom),r&&(r=r&&!window._.isEmpty(t.Errors)),r}e.$on("foldersSet",function(){e.folderSelectorBusy=!1}),e.canSave=function(){return!e.saveInProgress&&a()},e.destinationFolderSelected=function(i,r){e.destinationFolderName=i,e.destinationFolderId=r},e.saveMessage=function(){if(a()&&!e.saveInProgress){e.saveInProgress=!0;var t=e.messageDescription.trim(),s={};s[i.Qualtrics.User.language]=e.messageContent;var l={lid:e.selectedLibraryId,category:"MVD",description:t,folderId:e.destinationFolderId,message:s},d={"Content-Type":n};r.submit("SaveMessageEdit",{data:window.jQuery.param(l),headers:d,method:"POST"},{userBlocking:!0,userInit:!0,blocksNav:!0}).then(function(i){e.saveInProgress=!1,"function"==typeof e.onMessageSave&&e.onMessageSave(i),e.closeModal()},function(e){o.logError("Library.CreateNewMessage failed",e)})}},e.closeModal=function(){"function"==typeof e.onCloseModal&&e.onCloseModal(),e.$hide()},function(){e.folderData={},e.editing=!1,e.messageContent={},e.messageDescription="",e.saveInProgress=!1,e.folderSelectorBusy=!0,t.getForeignLibraryFolderData(e.selectedLibraryId,"Messages").then(function(i){e.folderData=i})}()}])},function(e,i,r){"use strict";var t=r(4),n=r(7),o=r(2);r.n(o);o.module("cp.surveys.edit").controller("EditSurveyBrandToolsController",["$scope","$window","userDetailsService","qtranslateFilter",function(e,i,r,o){function a(e){switch(e){case"sony":return[{label:o("EditSection.SonyImportMSQ"),action:s},{label:o("EditSection.SonyExportMSQ"),submenu:{items:[{label:o("EditSection.SonyExportMSQCsv"),action:l},{label:o("EditSection.SonyExportMSQZip"),action:d}]}},{label:o("EditSection.SonySendMSQTestData"),action:u}];default:return null}}function s(){i.QES_Global.saveSurvey(),i.QuestionActions.unselectAll(),i.QModules.loadModule("importsurvey.js"),i.Qualtrics.ImportSurvey.openImportSurveyWindow("UploadSonyMSQ",o("EditSection.SonyImportMSQ"))}function l(){c(!1)}function d(){c(!0)}function c(e){i.QES_Global.saveSurvey(),i.QuestionActions.unselectAll();var r={Type:"Sony",Questions:["AllQuestions"],DecimalFormat:".",UseExportTags:"yes",UnansweredValue:-99};e&&(r.ExportCompressed="yes"),i.Qualtrics.DownloadData.exportResponsesJob(r)}function u(){i.QES_Global.saveSurvey(),i.QuestionActions.unselectAll();var e=new i.Q_Window("MSQTestData",{title:o("EditSection.SonySendMSQTestData"),closeButton:!0,width:"auto"});e.setContent(i.QBuilder("div",{className:"Message"},"Sending...")),e.center(),new i.Ajax.Request(t.a.getAjaxURL("sendMSQTestData",null,{SurveyID:n.a.User.currentSurveyId}),{onComplete:function(r){var t=r.responseText.evalJSON();t.ErrorMessage?(e.clear(),e.setContent(i.QBuilder("div",{className:"Message"},[i.QBuilder("span",{className:"Error"},"Error: "+t.ErrorMessage)])),e.center()):e.destroy()}})}r.getBrandId().then(function(i){e.brandMenuItems=a(i)})}])},function(e,i,r){"use strict";var t=r(237),n=r.n(t),o=r(238),a=r.n(o),s=r(239),l=r.n(s),d=r(240),c=r.n(d),u=r(241),w=r.n(u),p=r(2);r.n(p);p.module("cp.surveys.edit").controller("EditSurveyController",["$scope","$window","$modal","$q","surveyToolsService","cpuiVersion","$compile","rum",function(e,i,r,t,o,s,d,u){function p(){var e=i.Survey.getInstance();if(!e.mobileCompatibilityChecker&&!i.Qualtrics.supportMode){var r=i.Survey.getInstance().id;e.mobileCompatibilityChecker=1,o.setMobileCompatibilityChecker(r,!0)}}var y=void 0,v=void 0,g=void 0,b=void 0,m=void 0;!function(){y=r({templateUrl:n.a,scope:e,show:!1,backdrop:"static"}),v=r({templateUrl:a.a,scope:e,show:!1,backdrop:"static"}),g=r({templateUrl:l.a,scope:e,show:!1,backdrop:"static"}),b=r({templateUrl:c.a,scope:e,show:!1,backdrop:"static"}),m=e.$new(),i.addEventListener("load",p),i.compileAngularElement=function(i){return d(i)(e)}}(),i.EditSurvey={},i.EditSurvey.showCopyBlockToLibraryModal=function(i){e.copyModal=y,e.sourceBlock={id:i.blockId,name:i.blockNameObj.text,hasReferenceListQuestion:i.hasReferenceListQuestion()},y.show()},i.EditSurvey.showCopyQuestionsToLibraryModal=function(i){e.copyModal=v,e.sourceBlock={id:i.blockId,name:i.blockNameObj.text},v.show()},i.Qualtrics.showCreateValidationModal=function(e,i,t,n){m.selectedLibraryId=e,m.onCloseModal=t,m.onMessageSave=i,r({templateUrl:w.a,scope:m,keyboard:!1,backdrop:n||!1})},i.EditSurvey.confirmModal=function(i,r,n){e.title=i,e.content=r,e.actionText=n;var o=t.defer(),a=o.promise;return e.answer=function(e){o.resolve(e),g.hide()},g.show(),a},i.EditSurvey.alertModal=function(i,r){e.title=i,e.content=r,b.show()}}])},function(e,i){var r="/ui/surveys/edit/default/html/templates/copyBlockToLibraryModal.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="modal copy-block-modal" tabindex="-1" role="dialog" id="copy-block-to-library_modal">\n  <div class="modal-dialog" ng-controller="CopyBlockToLibraryController">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h4 class="modal-title">{{\'EditSection.CopyBlockToLibrary\' | qtranslate}}</h4>\n      </div>\n      <div class="modal-body ">\n        <div class="type-graphic">\n          <div class="icon icon-block-framed-lg"></div>\n        </div>\n        <div class="form">\n          <div class="form-row">\n            <label class="label">{{\'EditSection.SelectLibrary\' | qtranslate}}</label>\n            <div qstrap.spin spin-if="librarySelectorBusy">\n              <span class="btn btn-select full-width" ng-model="libsWithPermission" ng-class="{active: menuIsOpen}" qstrap.select-menu items="libsWithPermissions" on-change="librarySelected($value, $item, $event)">\n                {{selectedLibrary.name}}\n                <div class="caret"></div>\n              </span>\n            </div>\n          </div>\n          <div class="form-row">\n            <label class="label">{{\'SiteWide.SelectFolder\' | qtranslate}}</label>\n            <folder-selector class="full-width" busy="folderSelectorBusy" ng-model="destinationFolderId" folder-data="folderData" selector-text="destinationFolderName" after-select="destinationFolderSelected($folderName, $folderId)"></folder-selector>\n          </div>\n          <div class="form-row">\n            <label class="label">{{\'SiteWide.Description\' | qtranslate}}</label>\n            <input type="text" class="input-text full-width" ng-model=\'newBlockName\'>\n          </div>\n        </div>\n      </div>\n      <div class="modal-footer">\n        <div class="btn btn-success" ng-click="sourceBlock.hasReferenceListQuestion || confirmCopy()" ng-disabled="sourceBlock.hasReferenceListQuestion" qstrap.tooltip position="top" content="{{\'EditSection.CopyReusableChoiceListQuestionToLibDisableMessage\' | qtranslate}}" tooltip-disabled="!sourceBlock.hasReferenceListQuestion">\n          {{\'SiteWide.Copy\' | qtranslate}}\n        </div>\n        <div class="btn btn-hover" ng-click="cancelCopy()">{{\'SiteWide.Cancel\' | qtranslate}}</div>\n      </div>\n    </div>\n  </div>\n</div>')}]),e.exports=r},function(e,i){var r="/ui/surveys/edit/default/html/templates/copyQuestionsToLibraryModal.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="modal copy-question-modal" tabindex="-1" role="dialog" id="copy-questions-to-library_modal">\n  <div class="modal-dialog" ng-controller="CopyQuestionsToLibraryController">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h4 class="modal-title">{{\'EditSection.CopyQuestionsToLibrary\' | qtranslate}}</h4>\n      </div>\n      <div class="modal-body">\n        <div class="type-graphic">\n          <div class="icon icon-bulletlist-framed-lg"></div>\n        </div>\n        <div class="form">\n          <div class="form-row">\n            <label class="label">{{\'EditSection.SelectLibrary\' | qtranslate}}</label>\n            <div qstrap.spin spin-if="librarySelectorBusy">\n              <span class="btn btn-select full-width" ng-model="libsWithPermission" ng-class="{active: menuIsOpen}" qstrap.select-menu items="libsWithPermissions" on-change="librarySelected($value, $item, $event)">\n                {{selectedLibrary.name}}\n                <div class="caret"></div>\n              </span>\n            </div>\n          </div>\n          <div class="form-row">\n            <label class="label">{{\'SiteWide.SelectFolder\' | qtranslate}}</label>\n            <folder-selector class="full-width" busy="folderSelectorBusy" ng-model="destinationFolderId" folder-data="folderData" selector-text="destinationFolderName" after-select="destinationFolderSelected($folderName, $folderId)"></folder-selector>\n          </div>\n          <table class="simple-table question-table">\n            <thead>\n              <tr>\n                <th>\n                  <span class="question-text-header">{{\'SiteWide.Question\' | qtranslate}}</span>\n                </th>\n                <th>{{\'SiteWide.Description\' | qtranslate}}</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr ng-repeat="question in questions">\n                <td qstrap.tooltip position="top" content="{{\'EditSection.CopyReusableChoiceListQuestionToLibDisableMessage\' | qtranslate}}" tooltip-disabled="!question.hasReferenceList">\n                  <span ng-class="{disabled: question.hasReferenceList}">\n                    <input type="checkbox" qstrap.checkbox ng-model="question.shouldCopy"/>\n                  </span>\n                  <span ng-class="{disabled: !question.shouldCopy}" class="question-old-text">{{question.text}}</span>\n                  </td>\n                <td ng-class="{disabled: !question.shouldCopy}"><input type="text" ng-model="question.newText" class="question-new-text input-text"></td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n      <div class="modal-footer">\n        <div class="btn btn-success" ng-click="confirmCopy()">{{\'SiteWide.Copy\' | qtranslate}}</div>\n        <div class="btn btn-hover" ng-click="cancelCopy()">{{\'SiteWide.Cancel\' | qtranslate}}</div>\n      </div>\n    </div>\n  </div>\n</div>')}]),e.exports=r},function(e,i){var r="/ui/surveys/edit/default/html/templates/confirmModal.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="modal confirm-modal" tabindex="-1" role="dialog"  id="surveys-confirm_modal">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h4 class="modal-title">{{title}}</h4>\n      </div>\n      <div class="modal-body ">\n        {{content}}\n      </div>\n      <div class="modal-footer">\n        <div class="btn btn-success" ng-click="answer(true)">{{actionText}}</div>\n        <div class="btn btn-hover" ng-click="answer(false)">{{\'SiteWide.Cancel\' | qtranslate}}</div>\n      </div>\n    </div>\n  </div>\n</div>\n')}]),e.exports=r},function(e,i){var r="/ui/surveys/edit/default/html/templates/alertModal.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="modal alert-modal" tabindex="-1" role="dialog" id="surveys-alert_modal">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h4 class="modal-title">{{title}}</h4>\n      </div>\n      <div class="modal-body ">\n        {{content}}\n      </div>\n      <div class="modal-footer">\n        <div class="btn btn-hover" ng-click="$hide()">{{\'SiteWide.OK\' | qtranslate}}</div>\n      </div>\n    </div>\n  </div>\n</div>\n')}]),e.exports=r},function(e,i){var r="/ui/surveys/edit/default/html/templates/createValidationModal.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="modal" tabindex="-1" role="dialog" id="create-validation-modal">\n  <div class="modal-dialog" class="create-validation-modal" ng-controller="CreateNewValidationController">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h4 class="modal-title" qtranslate>Messages.NewMessage</h4>\n      </div>\n      <div class="modal-body">\n        <div class="input-field-container">\n          <div class="message-description">\n            <div class="label" qtranslate>SiteWide.Description</div>\n            <input type="text" autofocus  ng-change="dataChanged()" class="input-text" id="messageDescriptionInput" ng-model="messageDescription"/>\n          </div>\n          <div class="message-category-container">\n            <div class="message-location">\n              <div class="label" qtranslate>EditSection.DestinationFolder</div>\n              <folder-selector ng-model="destinationFolderId" folder-data="folderData" auto-select="true" selector-text="destinationFolderName" after-select="destinationFolderSelected($folderName, $folderId)"></folder-selector>\n            </div>\n          </div>\n        </div>\n        <div validation-content-editor editing="editing" message-content="messageContent" message-id="message && message.id" errors-on-window="true" default-language="true">\n        </div>\n      </div>\n      <div class="modal-footer">\n        <div class="btn btn-success" ng-click="saveMessage()" ng-class="{disabled: !canSave()}">\n            <div class="icon btn-icon-check"></div>\n            <span qtranslate>LibrarySection.CreateMessageShort</span>\n          </div>\n          <div class="btn btn-hover" ng-click="closeModal()" qtranslate>SiteWide.Cancel</div>\n        </div>\n    </div>\n  </div>\n</div>\n')}]),e.exports=r},function(e,i,r){"use strict";var t=r(2);r.n(t);t.module("cp.surveys.edit").controller("EditSurveyToolbarController",["$scope",function(e){}])},function(e,i,r){"use strict";var t=r(446),n=r.n(t),o=r(205),a=r(244),s=r(12),l=r(54),d=r(2);r.n(d);d.module("cp.surveys.edit").service("editorConfigService",function(){return l}),d.module("cp.surveys.edit").controller("EditSurveyToolsController",["$scope","$window","$q","qtranslateFilter","surveyToolsService","cpFeatureService","surveyReferenceListService","qstrap.modal","editorConfigService",function(e,i,r,t,l,d,c,u,w){function p(){m(),f(),S()}function y(){Q=r.defer(),B=Q.promise}function v(){b(!0)}function g(){b(!1)}function b(e){l.getSurveyJSON().then(function(r){e?(console.dir(r),i.customErrorHandler&&i.customErrorHandler(t("SiteWide.SupportMode"))):window.jQuery("#SystemErrorArea").empty(),i.Qualtrics.supportMode=e;var n=i.Survey.getInstance();n.renderCount=0,n.defaultPreviewMode=e?0:1,n.resetPreviewModes(),n.refresh()})}function m(){return i.Qualtrics.User.permissions.accountPermissions.salesforceIntegration&&!M&&h("salesforce")&&(M=l.getSFTriggers().then(function(e){if(e&&e.triggers){var i=e.triggers;for(var r in i)if("SalesforceWebToLead"===i[r].TriggerAction?N=!0:"SalesforceResponseMapping"===i[r].TriggerAction?E=!0:"SalesforceOutboundMessage"===i[r].TriggerAction&&(I=!0),void 0!==N&&void 0!==E&&void 0!==I)break}})),M}function f(){return!!h("salesforce")&&d.getFeatureState("TNT.SalesforceIntegration").then(function(e){return T=e&&!!e.enabled})}function S(){return!!h("salesforce")&&d.getFeatureState("TNT.SalesforceOutboundMessage").then(function(e){return k=e&&!!e.enabled})}function h(e){return w.getConfig().toolsOptions[e]}function C(e,i){return w.getConfig().toolsOptions[e][i]}function L(){void 0===x&&(x=u({title:t("EditSection.VersionHistory"),className:"survey-versions-modal",controller:"SurveyVersionsController",templateUrl:n.a})),x.show()}var Q=void 0,B=void 0,M=void 0,T=void 0,k=void 0,x=void 0,N=void 0,E=void 0,I=void 0;e.getMenuDefItems=function(){return y(),r.all([B,m(),f(),S()]).then(function(e){var r=e[0].metaEnabled,n=!1;i.BaseForm.getInstance().versionId&&(n=function(){return!1});var l="Demo"==i.Qualtrics.System.brandType,d={divider:!0},u={label:t("EditSection.AutoNumberEllipsis"),action:n||i.QES_Global.autoNumberQuestions,disabled:!!n},p={label:t("EditSection.ResetRecodeValuesEllipsis"),action:n||i.QES_Global.openResetRecodeValuesModal,disabled:!!n},y=null,b=s.a.shouldShowCollaborateButton(),m={defaultPermissions:{editSurveys:1,translateSurveys:1,copySurveyQuestions:1,setSurveyOptions:1,createResponseSets:1,editQuestions:1,deleteSurveyQuestions:1,editSurveyFlow:1,useBlocks:1,useSkipLogic:1,useAEConjoint:1,useAETriggers:1,useAEQuotas:1,useScreenouts:1,useAdvancedQuotas:1,useTableOfContents:1,useReferenceBlocks:1}};!!(!i.Qualtrics.ThreeSixty||0===Object.keys(i.Qualtrics.ThreeSixty).length&&i.Qualtrics.ThreeSixty.constructor===Object)&&b&&i.Qualtrics.User.permissions.accountPermissions.shareSurveys&&(y={label:t("SiteWide.Sharing"),action:function(){return i.QES_Global.share("",i.Qualtrics.User.currentSurveyId,i.Qualtrics.User.currentSurveyName,"",m)}});var f=[{label:t("EditSection.SearchAndReplaceEllipsis"),action:n||i.QES_Global.openSearchAndReplace,disabled:!!n},{label:t("EditSection.StripFormattingEllipsis"),action:n||i.QES_Global.stripFormattingOnSelectedQuestions,disabled:!!n}];"EN"===i.Qualtrics.User.language&&f.push({label:t("EditSection.SpellCheck"),action:n||i.QES_Global.openSpellCheck,disabled:!!n}),h("generateTestResponses")&&f.push({label:t("EditSection.SurveyTesterLink"),action:n||i.QES_Global.openSurveyTester,disabled:!!n}),f.push({label:t("EditSection.CheckAccessibilityEllipsis"),action:n||i.QES_Global.checkAccessibility,disabled:!!n});var S=t("EditSection.OpenSurveyAnalysisModal");i.Survey.getInstance().getSurveyAnalysisDisabled()&&(S=t("EditSection.EnableSurveyAnalysisButtonText")),f.push({label:S,action:n||function(){return Object(a.b)(o.a.getInstance())},disabled:!!n}),i.Survey.getInstance().getSurveyAnalysisDisabled()||f.push({label:t("EditSection.DisableSurveyAnalysisButtonText"),action:n||function(){return Object(a.a)(o.a.getInstance())},disabled:!!n});var Q={label:t("EditSection.Review"),submenu:{items:f}},B=null;i.Survey.getInstance().getPermission("useAETriggers",!0)&&C("triggers","aeTriggers")?B={label:t("EditSection.Triggers"),submenu:{items:[{label:t("EditSection.EmailTriggersEllipsis"),action:i.QES_Global.openEmailTriggers},{label:t("EditSection.ContactListTriggersEllipsis"),action:i.QES_Global.openPanelTriggers}]}}:C("triggers","personTriggers")&&(B={label:t("EditSection.UpdatePersonTrigger"),action:i.QES_Global.showUpdatePersonDialog});var M=null;i.Qualtrics.User.permissions.accountPermissions.salesforceIntegration&&h("salesforce")?(M={label:t("EditSection.SalesForce"),submenu:{items:[{label:t("EditSection.SalesForceWTL"),action:i.QES_Global.openSalesforceLeadTrigger},{label:t("EditSection.SalesForceRM"),action:i.QES_Global.openSalesforceResponseMapping},{label:t("EditSection.SalesForceTES"),action:i.QES_Global.openSalesforceOutboundMessage},{label:t("EditSection.SalesForceSLSA"),action:i.QES_Global.openSalesforceAccountData}]}},k&&!I&&M.submenu.items.splice(2,1),T&&!E&&M.submenu.items.splice(1,1),T&&!N&&M.submenu.items.splice(0,1),1===M.submenu.items.length&&(M=null)):M=!T&&h("salesforce")?{label:t("EditSection.SalesForce"),submenu:{items:[{label:t("EditSection.SalesForceWTL"),action:i.QES_Global.openSalesforceLeadTrigger}]}}:null;var x=null;i.Qualtrics.User.permissions.accountPermissions.omnitureIntegration&&h("adobeAnalytics")&&(x={label:t("EditSection.Omniture"),action:i.QES_Global.openOmnitureConfig});var $=w.getConfig(),F=$.quotasEnabled,A=null;F&&(A={label:t("EditSection.QuotasEllipsis"),action:i.QES_Global.openQuotas});var D=!1,P=w.getConfig(),j=P.conjointEnabled;i.Survey.getInstance().getPermission("useAEConjoint")&&j&&(D={label:t("EditSection.ConjointsEllipsis"),action:n||i.QES_Global.openConjoints,disabled:!!n});var W={label:t("EditSection.ManageReusableChoicesEllipsis"),action:n||c.openModal,disabled:!!n},R=function(){s.a.scoreSurvey(i.Qualtrics.User.currentSurveyId)},O=null;w.getConfig();w.getConfig().scoringEnabled&&(O={label:t("EditSection.GradingEditorEllipsis"),action:n||R,disabled:!!n});var U=null,q=i.Survey.getInstance().getPermission("translateSurveys",!0);if(q||l){var _=function(){!q&&l?i.QualtricsCPTools.showUpgradeDialog("Translate"):s.a.translateSurvey(i.Qualtrics.User.currentSurveyId)};U={label:t("EditSection.TranslateSurveyEllipsis"),action:n||_,disabled:!!n}}var G={label:t("EditSection.Versions"),submenu:{items:[{label:t("EditSection.CreateNewVersionEllipsis"),action:n||i.QES_Global.openCreateVersion,disabled:!!n},{label:t("EditSection.ViewVersionHistoryEllipsis"),action:L}]}},V={label:t("EditSection.ImportExport"),submenu:{items:[{label:t("EditSection.PrintSurveyEllipsis"),action:i.QES_Global.printForm},{label:t("EditSection.ImportSurveyEllipsis"),action:n||i.QES_Global.importSurvey,disabled:!!n},{label:t("EditSection.ExportSurvey"),action:i.QES_Global.exportSurvey},{label:t("EditSection.ExportSurveyToWordEllipsis"),action:i.QES_Global.exportSurveyToWordDialog}]}},H=[];if(H.push(u),H.push(p),y&&H.push(y),H.push(Q),H.push(d),B&&H.push(B),M&&H.push(M),x&&H.push(x),(B||M||x)&&H.push(d),A&&H.push(A),D&&H.push(D),H.push(W),O&&H.push(O),U&&H.push(U),H.push(d),H.push(G),H.push(V),r||i.Qualtrics.supportMode){var J=v;i.Qualtrics.supportMode&&(J=g);var X=i.BaseForm.getInstance()&&i.BaseForm.getInstance().defaultPreviewMode,z={label:t("EditSection.SurveyPreviewMode"),action:i.toggleSurveyPreviewMode,selected:X},K=i.BaseForm.getInstance()&&i.BaseForm.getInstance().mobileCompatibilityChecker,Y={label:t("EditSection.MobileCompatibilityChecker"),action:n||i.toggleMobileCompatiblityChecker,selected:K,disabled:!!n},Z={label:t("SiteWide.SupportMode"),action:J,selected:i.Qualtrics.supportMode};H.push(d),H.push(z),H.push(Y),H.push(Z)}return H})},e.gatherEventData=function(e){var i=e&&e.shiftKey&&(e.ctrlKey||e.metaKey);Q.resolve({metaEnabled:i}),p()}}])},function(e,i,r){"use strict";function t(e){var i=document.createElement("div");i.innerHTML=Object(o.default)("EditSection","DisableSurveyAnalysis"),window.QualtricsCPTools.showConfirmDialog({title:Object(o.default)("EditSection","DisableSurveyAnalysisTitle"),message:i,okCallBack:function(){r(1).default.getInstance().setSurveyAnalysisDisabledStatus(!0),e.closeModal()},width:"500px",okText:Object(o.default)("SiteWide","Disable"),negativeConfirm:!0,cancelText:Object(o.default)("SiteWide","Cancel"),className:"survey-iq-optout disable"})}function n(e){var i=r(1).default;if(i.getInstance().getSurveyAnalysisDisabled()){var t=document.createElement("div");t.innerHTML=Object(o.default)("EditSection","EnableSurveyAnalysis"),window.QualtricsCPTools.showConfirmDialog({title:Object(o.default)("EditSection","EnableSurveyAnalysisTitle"),message:t,okCallBack:function(){i.getInstance().setSurveyAnalysisDisabledStatus(!1),a.default.reanalyzeSurvey(),e.openModal()},width:"500px",okText:Object(o.default)("SiteWide","Enable"),cancelText:Object(o.default)("SiteWide","Cancel"),className:"survey-iq-optout enable"})}else e.openModal()}i.a=t,i.b=n;var o=r(0),a=r(119)},function(e,i,r){"use strict";function t(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}var n=r(2),o=(r.n(n),function(){function e(e,i){for(var r=0;r<i.length;r++){var t=i[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(i,r,t){return r&&e(i.prototype,r),t&&e(i,t),i}}()),a=function(){function e(i,r,n,o,a){t(this,e),this.$scope=i,this.$window=r,this.$q=n,this.qmodal=o,this.qtranslate=a,this.$scope.getMenuDefItems=this.getMenuDefItems.bind(this)}return o(e,[{key:"getMenuDefItems",value:function(){var e={divider:!0},i={label:this.qtranslate("SiteWide.LookAndFeel")+"...",icon:"icon-paintbrush",action:this.$window.QES_Global.openLookAndFeel},r={label:this.qtranslate("EditSection.SurveyOptions")+"...",icon:"icon-gear",action:this.$window.QES_Global.openOptions},t=[];return t.push(i),t.push(e),t.push(r),t}}]),e}();n.module("cp.surveys.edit").controller("SurveyOptionsController",a),a.$inject=["$scope","$window","$q","qstrap.modal","qtranslateFilter"]},function(e,i,r){"use strict";var t=r(2);r.n(t),r(444);t.module("cp.surveys.edit").controller("JumpStartFieldsController",["$scope","$window","$http","projectFieldsMetricsService",function(e,i,r,n){function o(e,r){i.Qualtrics.SearchAndReplace.internalReplaceAll(e,r)}function a(e){return r.post(i.URLTools.getAjaxURL("setProjectBundle","ControlPanel"),{projectBundle:e})}function s(i){for(var r=i.data.bundle.resources[0].inputVariables,t={},n=0;n<r.length;n++)t[r[n].key]=r[n].label;e.keyLabelObj=t}var l=i.Survey.getInstance().jumpstart;if(l&&l.ContentBundle){var d=t.copy(l);e.projectFields=d.ContentBundle.SurveyInputVariables,e.validJumpStart=!0,e.collapseFieldsContainer=!1,e.disableReplaceBtns=!1,e.alwaysTrue=!0,e.keyLabelObj,e.validJumpStart=!0,function(t){var n={params:{lang:i.Qualtrics.User.language}};r.get("/project-content-registry/v2/bundles/"+t,n).then(s,function(i){e.validJumpStart=!1})}(d.ContentBundle.BundleShortName),function(){for(var i=0;i<e.projectFields.length;i++){var r=/<\/?span[^>]*>/g;e.projectFields[i].Value=e.projectFields[i].Value.replace(r,"")}}(),e.replaceField=function(i){e.disableReplaceBtns=!0;var r=t.copy(l),s=e.projectFields.map(function(e){return e.Key}).indexOf(i),d=l.ContentBundle.SurveyInputVariables[s].Value,c="<span class='projectFieldVal'>"+e.projectFields[s].Value+"</span>";return n.logAction("jumpStartFieldChanged"),d===c?void(e.disableReplaceBtns=!1):(r.ContentBundle.SurveyInputVariables[s].Value=c,a(r).then(function(){o(d,c),l=r}).finally(function(){e.disableReplaceBtns=!1}))},e.toggleFieldsContainer=function(){e.collapseFieldsContainer=!e.collapseFieldsContainer}}}])},function(e,i,r){"use strict";var t=r(12),n=r(2);r.n(n);n.module("cp.surveys.edit").controller("ShareProjectController",["$scope","$window","$q",function(e,i,r){function n(){var e=r.when(i.Qualtrics.User.currentSurveyId),t=r.when(i.Qualtrics.User.currentSurveyName);return r.all({currentSurveyId:e,currentSurveyName:t}).then(function(e){var r={defaultPermissions:{editSurveys:1,translateSurveys:1,copySurveyQuestions:1,setSurveyOptions:1,createResponseSets:1,editQuestions:1,deleteSurveyQuestions:1,editSurveyFlow:1,useBlocks:1,useSkipLogic:1,useAEConjoint:1,useAETriggers:1,useAEQuotas:1,useScreenouts:1,useAdvancedQuotas:1,useTableOfContents:1,useReferenceBlocks:1}};i.QES_Global.share("",e.currentSurveyId,e.currentSurveyName,"",r)})}e.shouldShowCollaborateButton=t.a.shouldShowCollaborateButton(),e.openShareProject=n}])},function(e,i,r){"use strict";var t=r(2);r.n(t);t.module("cp.surveys.edit").controller("TextEntryController",["$scope","$window",function(e,i){e.onTextInputSizeChanged=function(e){var r=e.width,t=e.height,n=void 0;i.QuestionActions&&1===i.QuestionActions.selectedRegistry.length&&(n=i.QuestionActions.selectedRegistry[0],n.options.InputWidth=r,n.options.InputHeight=t,n.setSaved(!1))},e.onFormInputSizeChanged=function(e,r){var t=r.width,n=r.height,o=void 0,a=void 0;if(i.QuestionActions&&1===i.QuestionActions.selectedRegistry.length)for(var s=i.QuestionActions.selectedRegistry[0].choices,l=0;l<s.length;l++)if(parseInt(s[l].choiceId)===e+1){o=i.QuestionActions.selectedRegistry[0],a=o.choices[l],a.meta||(a.meta={}),a.meta.InputWidth=t,a.meta.InputHeight=n,o.setSaved(!1);break}}}])},function(e,i,r){"use strict";var t=r(250),n=r.n(t),o=r(2);r.n(o);o.module("cp.surveys.edit").directive("editSurveyBrandTools",["cpuiVersion",function(e){return{restrict:"A",templateUrl:n.a,controller:"EditSurveyBrandToolsController"}}])},function(e,i){var r="/ui/surveys/edit/default/html/templates/editSurveyBrandTools.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div ng-if="brandMenuItems" class="btn btn-hover btn-select" qstrap.menu items="brandMenuItems">\n\t<span qtranslate>EditSection.OrganizationTools</span>\n\t<span class="caret"></span>\n</div>\n')}]),e.exports=r},function(e,i,r){"use strict";var t=r(252),n=r.n(t),o=r(2);r.n(o);o.module("cp.surveys.edit").directive("editSurveyTools",["cpuiVersion",function(e){return{restrict:"A",scope:!0,templateUrl:n.a,controller:"EditSurveyToolsController"}}])},function(e,i){var r="/ui/surveys/edit/default/html/templates/editSurveyTools.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="btn btn-hover btn-select" qstrap.menu ng-mousedown="gatherEventData($event)" items="getMenuDefItems()">\n\t<span class="icon toolbar-icon-wrench"></span>\n\t<span qtranslate>EditSection.Tools</span>\n\t<span class="caret"></span>\n</div>')}]),e.exports=r},function(e,i,r){"use strict";var t=r(254),n=r.n(t),o=r(2);r.n(o);o.module("cp.surveys.edit").directive("surveyOptions",["cpuiVersion",function(e){return{restrict:"A",scope:!0,templateUrl:n.a,controller:"SurveyOptionsController"}}])},function(e,i){var r="/ui/surveys/edit/default/html/templates/surveyOptions.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="btn btn-hover btn-select" qstrap.menu ng-mousedown="gatherEventData($event)" items="getMenuDefItems()">\n\t<span class="icon toolbar-icon-gear"></span>\n\t<span qtranslate>SiteWide.Settings</span>\n\t<span class="caret"></span>\n</div>')}]),e.exports=r},function(e,i,r){"use strict";var t=r(256),n=r.n(t),o=r(2);r.n(o);o.module("cp.surveys.edit").directive("jumpStartFields",["cpuiVersion",function(e){return{restrict:"A",templateUrl:n.a,controller:"JumpStartFieldsController"}}])},function(e,i){var r="/ui/surveys/edit/default/html/templates/jumpStartFields.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div ng-if="projectFields.length && validJumpStart">\n\t<div id="JumpStart" class="Block Default BlockPreview">\n\t\t<div class="BlockBorder">\n\t\t\t<div class="HeaderContainer">\n\t\t\t\t<div class="BlockHeader DefaultBlock" instanceid="block_jumpstart">\n\t\t\t\t\t<div class="ExpandArrow Button Round" ng-click="toggleFieldsContainer()" ng-class="{rotated: collapseFieldsContainer}"><b bubbleup="true"><b bubbleup="true"></b></b></div>\n\t\t\t\t\t<span class="BlockTitle">{{\'EditSection.ProjectFieldsBlockTitle\' | qtranslate}}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="FieldsContainer" ng-hide="collapseFieldsContainer">\n\t\t\t\t\t<div ng-repeat="field in projectFields" class="projectField">\n\t\t\t\t\t\t<label>{{keyLabelObj[field.Key]}}</label>\n\t\t\t\t\t\t<input ng-model="field.Value">\n\t\t\t\t\t\t<div qstrap.spin spin-if="disableReplaceBtns" class="btn btn-primary" ng-class="{disabled: disableReplaceBtns || !field.Value}" ng-click="replaceField(field.Key)"><span></span>{{\'EditSection.Replace\' | qtranslate}}</div>\n\t\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>')}]),e.exports=r},function(e,i,r){"use strict";var t=r(258),n=r.n(t),o=r(2);r.n(o);o.module("cp.surveys.edit").directive("shareProject",["cpuiVersion",function(e){return{restrict:"A",templateUrl:n.a,controller:"ShareProjectController"}}])},function(e,i){var r="/ui/surveys/edit/default/html/templates/shareProject.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="btn btn-hover" ng-click="openShareProject()" ng-if="shouldShowCollaborateButton">\n\t<span class="icon icon-collaborate-lg"></span>\n\t<span qtranslate>SiteWide.Sharing</span>\n</div>')}]),e.exports=r},function(e,i,r){"use strict";var t=r(2);r.n(t);t.module("cp.surveys.edit").directive("inputFocusSelection",["$timeout",function(e){return{restrict:"A",scope:{toWatch:"&inputFocusSelection"},link:function(i,r,t){i.$watch(i.toWatch,function(i,t){e(function(){var e=r[0];i?(e.focus(),e.setSelectionRange(0,e.value.length)):e.blur()})})}}}])},function(e,i){!function(e){function i(e,i,r,t){var n=[],o=0;this.getCurrentLogRequestsRunning=function(){return o},this.getMaxConcurrentLogRequests=function(){return 2},this.logAction=function(e,i){var r=i||{};r.target=e,a(r,"/rum/genesis-dev-client-logging?")};var a=function(e,i){i=i||"/rum/genesis-dev-client-logging?",e.timestamp=(new Date).toUTCString(),e.sessionId=d(),e.brandId=r.Qualtrics.System.brandId,e.userId=r.Qualtrics.User.userId,e.section=r.Qualtrics.System.section,e.userAgent=r.navigator.userAgent;var t=JSON.stringify(e);n.push(i+t),s()},s=function(){var e=void 0;o<2&&n.length>0&&(e=n.shift(),l(e))},l=function(i){if(!i){var r="Cannot make a log request without a url";throw console.error(r),new Error(r)}o++,e({method:"GET",url:i,timeout:3e3}).finally(function(){o--,s()})},d=function(){var e=i.get("LoggingSessID");return e||(e=t.generateGuid(),i.put("LoggingSessID",e)),e}}e.service("projectFieldsMetricsService",["$http","$cookies","$window","guidService",i])}(angular.module("cp.surveys.edit"))},function(e,i){angular.module("cp.surveys.edit").factory("surveyToolsService",["qhttp",function(e){var i=this;return i.getSurveyJSON=function(){return e.submit("GetSurveyJSON",{url:"Ajax.php"})},i.setMobileCompatibilityChecker=function(i,r){return e.submit("SetMobileCompatibilityChecker",{url:"Ajax.php",params:{SurveyID:i,value:r?1:0},method:"POST"},{userBlocking:!0,userInit:!0,blocksNav:!0})},i.getSFTriggers=function(){return e.submit("getSFTriggers",{url:"Ajax.php",method:"POST"})},i}])},function(e,i,r){"use strict";var t=r(263),n=(r.n(t),r(264)),o=(r.n(n),r(265));r.n(o)},function(e,i){!function(){"use strict";angular.module("cp.xmproject",[])}()},function(e,i){angular.module("cp.xmproject").service("projectPermissionsService",["$http","$window","xmPermissionsService","$q",function(e,i,r,t){function n(){var e=[{name:"Research Core",icon:"icon-research-core",key:"CORE"},{name:"Customer Experience",icon:"icon-customer-experience",key:"CX"},{name:"Employee Experience",icon:"icon-employee-experience",key:"EX"},{name:"Product Experience",icon:"icon-product-experience",key:"PX"},{name:"Brand Experience",icon:"icon-brand-experience",key:"BX"}];return t.all(e.map(function(e){var i=e.key;return"CORE"===i&&(i="ResearchCore"),console.log(i),i+="Category",r.isProductLineEntitled(i).then(function(t){return!("CORE"===e.key&&!t)&&(!(!t&&d.isDismissed(e.key))&&(!t||r.canCreateInProductLine(i)))})})).then(function(i){return e.filter(function(e,r){return i[r]})})}function o(e){return i.localStorage.getItem(s(e))===l}function a(e){i.localStorage.setItem(s(e),l)}var s=function(e){return"categoriesDismissed."+e},l="true",d={isDismissed:o,dismissCategory:a,getAllowedCategories:n};return d}])},function(e,i){!function(){function e(e,n,o,a){function s(){if(!g){g=!0;var e=n.Qualtrics.User.permissions.accountPermissions;e.createSIProjects=Boolean(e.createZone||e.administerSiteIntercept)}}function l(e){s();var r=t[e];if(!r)return!1;if(!c(r.productLine))return!1;var o=r.permissions&&r.permissions.access&&i(r.permissions.access)(n.Qualtrics.User.permissions);if(r.features&&r.features.access){var a=i(r.features.access)(n.Qualtrics.Features);return r.features.overridePermissions?a:a&&o}return o}function d(e){if(s(),!l(e))return!1;var r=t[e];return!r.permissions.create||i(r.permissions.create)(n.Qualtrics.User.permissions)}function c(e){return n.Qualtrics.User.permissions.projectPermissions[e]}function u(e){var i=r[e];if(!i||!c(e))return!1;for(var t=0;t<i.length;t++)if(d(i[t]))return!0;return!1}function w(){for(var e=0;e<o.length;e++)if(u(o[e]))return!0;return!1}function p(e){return v().then(i(e))}function y(){return o.map(p).reduce(function(e,i){return e.then(function(e){return!!e||i})},a.when(!1))}function v(){if(n.Qualtrics.System.brandCategoryEntitlements){var r=["CXCategory","EXCategory","BXCategory","PXCategory","ResearchCoreCategory"],t={};return r.forEach(function(e){t[e]="0"!==n.Qualtrics.System.brandCategoryEntitlements[e]}),a.when(t)}return e.get("/cpui/project-permissions/",{cache:!0}).then(i("data"))}var g=!1;return{canAccessProjectType:l,canCreateProjectType:d,canAccessProductLine:c,canCreateInProductLine:u,canCreateAnyProject:w,isProductLineEntitled:p,isAnyProductLineEntitled:y}}function i(e){return function(i){return e.split(".").reduce(function(e,i){return void 0===e||null===e?0:e[i]},i)}}angular.module("cp.xmproject").factory("xmPermissionsService",e).value("productLines",["CXCategory","EXCategory","BXCategory","PXCategory","ResearchCoreCategory"]).value("projectTypes",["siteIntercept","vocalize","featureRequest","conjoint","employeeEngagement","employeePulse","threeSixty","employeeLifecycle","importedData","CXSurveyProject","EXSurveyProject","BXSurveyProject","PXSurveyProject","RCSurveyProject"]);var r={CXCategory:["CXSurveyProject","vocalize","siteIntercept"],EXCategory:["EXSurveyProject","employeeEngagement","employeePulse","threeSixty","employeeLifecycle"],BXCategory:["BXSurveyProject"],PXCategory:["PXSurveyProject","featureRequest","conjoint"],ResearchCoreCategory:["RCSurveyProject","importedData","siteIntercept"]},t={CXSurveyProject:{permissions:{access:"projectPermissions.CXSurveyProject",create:"accountPermissions.createSurveys"},productLine:"CXCategory"},vocalize:{permissions:{access:"accountPermissions.useVocalize",create:"accountPermissions.createVocalizeProjects"},features:{access:"VocalizeGenesisIntegration"},productLine:"CXCategory"},EXSurveyProject:{permissions:{access:"projectPermissions.EXSurveyProject",create:"accountPermissions.createSurveys"},productLine:"EXCategory"},employeeEngagement:{permissions:{access:"projectPermissions.employeeEngagement",create:"accountPermissions.createThreeSixties"},productLine:"EXCategory"},employeePulse:{permissions:{access:"projectPermissions.employeePulse",create:"accountPermissions.createThreeSixties"},productLine:"EXCategory"},threeSixty:{permissions:{access:"projectPermissions.threeSixty",create:"accountPermissions.createThreeSixties"},productLine:"EXCategory"},employeeLifecycle:{permissions:{access:"projectPermissions.employeeLifecycle",create:"accountPermissions.createThreeSixties"},features:{access:"EX_EnableEmployeeLifecycle"},productLine:"EXCategory"},BXSurveyProject:{permissions:{access:"projectPermissions.BXSurveyProject",create:"accountPermissions.createSurveys"},productLine:"BXCategory"},PXSurveyProject:{permissions:{access:"projectPermissions.PXSurveyProject",create:"accountPermissions.createSurveys"},productLine:"PXCategory"},featureRequest:{permissions:{create:"accountPermissions.createSurveys"},features:{access:"PX_FeatureRequest",overridePermissions:!0},productLine:"PXCategory"},conjoint:{permissions:{create:"accountPermissions.createSurveys"},features:{access:"PX_Conjoint",overridePermissions:!0},productLine:"PXCategory"},RCSurveyProject:{permissions:{access:"projectPermissions.RCSurveyProject",create:"accountPermissions.createSurveys"},productLine:"ResearchCoreCategory"},importedData:{permissions:{access:"accountPermissions.useImportedDataProjects",create:"accountPermissions.useImportedDataProjects"},productLine:"ResearchCoreCategory"},siteIntercept:{permissions:{access:"accountPermissions.accessSiteIntercept",create:"accountPermissions.createSIProjects"},features:{access:"SIZonesInMyProjects"},productLine:"ResearchCoreCategory"}};e.$inject=["$http","$window","productLines","$q"]}()}],[229]);