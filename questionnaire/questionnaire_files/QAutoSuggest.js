webpackJsonp([2],{693:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"AutoSuggestMenuPane",function(){return u});var n=i(21),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=window.Class.create({initialize:function(t){t=t||{},this.options=t,t.id?this.id=t.id:this.id=window.QualtricsTools.createNewId("QAS"),window.Qualtrics.AutoSuggest.reg[this.id]=this},build:function(t){var e="";this.options.inputClass&&(e=" "+this.options.inputClass);var i={autocomplete:"off",className:"TextBox"+e,id:this.id,keyentercallback:"Event.stop($evt)"};return this.options.tabIndex&&(i.tabindex=this.options.tabIndex),this.options.size&&(i.size=this.options.size),this.options.name&&(i.name=this.options.name),this.options.inputId&&(i.id=this.options.inputId),this.input=window.QBuilder("input",i),this.input.onblur=this.blurHandler.bind(this),this.options.prompt&&(this.input.value=this.options.prompt,this.input.setAttribute("autoclear",this.options.prompt),window.$(this.input).addClassName("AutoClearMessage")),void 0!==this.options.inputValue&&(this.input.value=this.options.inputValue,window.$(this.input).removeClassName("AutoClearMessage")),t||this.focusInput(0),window.Event.observe(this.input,"keyup",this.inputChange.bindAsEventListener(this)),window.Event.observe(this.input,"keydown",this.keyDown.bind(this)),this.options.fieldName=this.options.fieldName||this.id+"_HiddenValueField",this.options.insertValue&&(this.options.hiddenInput=!1),0!=this.options.hiddenInput&&(this.hiddenInput=window.QBuilder("input",{type:"hidden",id:this.options.fieldName})),this.hiddenInput&&void 0!==this.options.hiddenInputValue&&(this.hiddenInput.value=this.options.hiddenInputValue),this.container=window.QBuilder("div",{id:"QAutoSuggest",className:"QSuggest "+(this.options.className||"")},[this.input]),this.options.useButton&&this.container.appendChild(this.buildButton()),this.hiddenInput&&this.container.appendChild(this.hiddenInput),this.input.valid=!1,this.container},blurHandler:function(){if(!this.options.avoidBlur){var t=this.getMenuDef(),e=t.ajax.parameters||{},i=t.ajax.url||n.a.getAjaxURL(t.ajax.action,null,t.ajax.queryParams),s=this;new window.Ajax.CachedRequest(i,{parameters:e,onSuccess:function(t){var e=t.responseText.evalJSON();e=e.items;var i=s.input.value,n="value";s.options.insertValue||(n="text");for(var o in e){var u=e[o];u[n]&&u[n]==i&&(s.hiddenInput&&(s.hiddenInput.value=u.value),s.options.onSelect&&s.options.onSelect(u.value,s.input,u))}}})}},focusInput:function(t){window.QualtricsTools.focusInput.curry(this.input,t).defer()},keyDown:function(t){var e=t.keyCode;switch(e){case window.Event.KEY_TAB:if(this.menupane){this.menupane.destroy(),this.menupane=null;break}this.options.onKeyTab?this.options.onKeyTab(t,this):(this.showMenuDelayed(""),window.Event.stop(t));break;case window.Event.KEY_RETURN:e==window.Event.KEY_RETURN&&this.options.onKeyEnter?this.options.onKeyEnter(t,this):this.menupane||(this.showMenuDelayed(""),window.Event.stop(t));break;case window.Event.KEY_DOWN:this.menupane?(window.Event.element(t).blur(),window.Qualtrics.Menu.down(t)):this.showMenuDelayed("")}},inputChange:function(t){if(0!=this.options.inputTriggersSuggest||this.menupane){switch(t.keyCode){case window.Event.KEY_TAB:case window.Event.KEY_UP:case window.Event.KEY_DOWN:case window.Event.KEY_RETURN:return}var e=window.Event.element(t),i=window.$F(e);this.showMenuDelayed(i,.5)}},getMenuDef:function(){var t={};if(this.options.parameters)for(var e in this.options.parameters){var i=this.options.parameters[e];"$searchValue"==i&&(i=window.Qualtrics.getInputValue(this.input)),t[e]=i}return{ajax:{action:this.options.action,parameters:t,preparser:this.options.preparser}}},showMenu:function(t){try{if(!t&&this.menupane)return this.menupane.destroy(),void(this.menupane=null);this.menupane?this.menupane.refreshMenu():this.menupane||this.options.action&&(this.menupane=new window.Qualtrics.AutoSuggestMenuPane(this.getMenuDef.bind(this),this.input,null,{positionCallback:this.getCustomMenuPosition.bind(this),processDefinition:this.options.processDefinition,autoSuggestObj:this,className:this.options.menuClass,allowMultipleMenus:!0}),this.menupane.onClose=this.onMenuClose.bind(this),this.menupane.autoSuggestObj=this)}catch(t){console.error("Error showing list: "+t)}},onMenuClose:function(){this.menupane=null},menuComplete:function(){this.options.onShowMenu&&this.options.onShowMenu(this.options)},getCustomMenuPosition:function(){var t=this.options.menuWidth||this.input.offsetWidth;if(this.options.positionXY){var e=this.options.useContainerForPosition?this.container:this.input,i=window.findPosY(e,!0);return{width:t,x:window.findPosX(e),y:i+e.offsetHeight}}return{width:t}},showMenuDelayed:function(t,e){this.listTimer&&(window.clearTimeout(this.listTimer),this.listTimer=null),null==t&&(t=window.Qualtrics.getInputValue(this.input)),this.focusInput(),this.listTimer=this.showMenu.bind(this,t).delay(e||0)},buildButton:function(){return window.QBuilder("button",{tabindex:"-1",type:"button",id:this.options.buttonId,className:"ComboBoxButton",preventdragscroll:!0,downcallback:"window.Qualtrics.AutoSuggest.showMenuDelayed",instanceid:this.id},"V")}});o.reg={},o.getInstance=window.QualtricsTools.getInstanceHelper(o.reg),window.Qualtrics.AutoSuggest=o,e.default=o;var u=window.Class.create(window.Qualtrics.MenuPane,{getItemCallback:function(t,e){return t.disabled?"":t.action?t.action:"window.Qualtrics.MenuPane.ItemSelect:"+this.id+"("+e+")"},ItemSelect:function(t){var e=this.menuDef.items[t],i=this.getItemDisplay(e);"object"==(void 0===i?"undefined":s(i))&&i.nodeType&&(i=i.innerHTML.stripTags()),i=i.stripTags();var n=this.getItemValue(e);this.autoSuggestObj.hiddenInput&&(this.autoSuggestObj.hiddenInput.value=n),this.autoSuggestObj.options.insertValue?this.autoSuggestObj.input&&(this.autoSuggestObj.input.value=n):this.autoSuggestObj.input&&(this.autoSuggestObj.input.value=i),this.autoSuggestObj.options.onSelect&&this.autoSuggestObj.options.onSelect(n,this.autoSuggestObj.input,e)},onShowMenu:function(){void 0!==this.menuDef.items&&this.autoSuggestObj.menuComplete.bind(this.autoSuggestObj)()},processItemDisplay:function(t){t=t.escapeHTML();var e=this.autoSuggestObj.input.value,i=new RegExp(e,"i"),n=this.findEntryMatch(t,i,"match"),s=window.QBuilder("span");return s.innerHTML=n,s},findEntryMatch:function(t,e,i){var n=t.match(e);return n?t.replace(e,"<span bubbleup='true' class='"+i+"'>"+n+"</span>"):t},evaluateAjaxMenu:function(t){var e=t.delay||!1;this.parentMenu&&(e=200);var i=t.ajax.url||n.a.getAjaxURL(t.ajax.action,null,t.ajax.queryParams);window.$(this.options.autoSuggestObj.input).addClassName("Searching"),window.Qualtrics.Menu.getAjaxData(i,{parameters:t.ajax.parameters,onComplete:this.getAjaxComplete(t.ajax)},e)},getAjaxComplete:function(t){var e=this;if(t=t||{},void 0===e.autoSuggestObj||e.autoSuggestObj.input&&!window.Qualtrics.getInputValue(e.autoSuggestObj.input)&&!0===e.autoSuggestObj.input.hasBeenLoadedBefore)for(var i=(new Date).getTime()+500;(new Date).getTime()<i;);return function(i){try{if(window.$(e.options.autoSuggestObj.input).removeClassName("Searching"),e.autoSuggestObj.input.hasBeenLoadedBefore=!0,e.destroyed)return;var n=i.responseText;t.preparser&&(n=window.Qualtrics.Event.executeDotSyntax(t.preparser,null,null,[n]));var s=window.Qualtrics.parseJSON(n),o=void 0;o=s.Error?[]:s&&!s.items?e.createMenuDefFromFlatObject(s):s,e.replaceMenuDefinition(o)}catch(t){console.error(t)}}}});window.Qualtrics.AutoSuggestMenuPane=u}});